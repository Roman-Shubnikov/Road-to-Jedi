{"ast":null,"code":"import _defineProperty from\"C:\\\\Users\\\\rshub\\\\Desktop\\\\Road-to-Jedi\\\\mobile-road\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/defineProperty\";import _classCallCheck from\"C:\\\\Users\\\\rshub\\\\Desktop\\\\Road-to-Jedi\\\\mobile-road\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/classCallCheck\";import _createClass from\"C:\\\\Users\\\\rshub\\\\Desktop\\\\Road-to-Jedi\\\\mobile-road\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/createClass\";import _inherits from\"C:\\\\Users\\\\rshub\\\\Desktop\\\\Road-to-Jedi\\\\mobile-road\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/inherits\";import _createSuper from\"C:\\\\Users\\\\rshub\\\\Desktop\\\\Road-to-Jedi\\\\mobile-road\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/createSuper\";import React from'react';// React\nimport bridge from'@vkontakte/vk-bridge';// VK Brige\nimport music from'./music/Soloriver.mp3';import{Alert,Avatar,ScreenSpinner,Snackbar,Tabbar,TabbarItem,Epic,ConfigProvider}from'@vkontakte/vkui';import'@vkontakte/vkui/dist/vkui.css';import'./style.css';// Импортируем панели\nimport Questions from'./panels/questions/main';import Top from'./panels/topUsers/main';import Notification from'./panels/notify/main';import Profile from'./panels/Profile/main';import Start from'./panels/Start/main';import Icon28Profile from'@vkontakte/icons/dist/28/profile';import Icon16CheckCircle from'@vkontakte/icons/dist/16/check_circle';import Icon28ArticleOutline from'@vkontakte/icons/dist/28/article_outline';import Icon28FavoriteOutline from'@vkontakte/icons/dist/28/favorite_outline';// const queryString = require('query-string');\nvar platformname=/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent);// const parsedHash = queryString.parse(window.location.search.replace('?', ''));\n// const hash = queryString.parse(window.location.hash);\nvar blueBackground={backgroundColor:'var(--accent)'};function isEmpty(obj){for(var key in obj){// если тело цикла начнет выполняться - значит в объекте есть свойства\nreturn false;}return true;}var App=/*#__PURE__*/function(_React$Component){_inherits(App,_React$Component);var _super=_createSuper(App);function App(props){var _this;_classCallCheck(this,App);_this=_super.call(this,props);_this.state={account:[],activeStory:'questions',scheme:\"bright_light\",default_scheme:\"bright_light\",api_url:\"https://xelene.ru/road/php/index.php?\",popout:/*#__PURE__*/React.createElement(ScreenSpinner,null),snackbar:null,switchKeys:false,need_epic:true};_this.changeData=function(name,value){_this.setState(_defineProperty({},name,value));};_this.LoadProfile=function(){fetch(_this.state.api_url+\"method=account.get&\"+window.location.search.replace('?','')).then(function(res){return res.json();}).then(function(data){if(data.result){_this.setState({account:data.response,popout:null,switchKeys:data.response.noti});if(!isEmpty(_this.state.account)){if(Number(_this.state.account.scheme)===0){_this.setState({scheme:_this.state.default_scheme});if(_this.state.default_scheme==='bright_light'){if(platformname){bridge.send(\"VKWebAppSetViewSettings\",{\"status_bar_style\":\"dark\",\"action_bar_color\":\"#FFFFFF\",'navigation_bar_color':\"#FFFFFF\"});}}if(_this.state.default_scheme==='space_gray'){if(platformname){bridge.send(\"VKWebAppSetViewSettings\",{\"status_bar_style\":\"light\",\"action_bar_color\":\"#19191A\",'navigation_bar_color':\"#19191A\"});}}}if(Number(_this.state.account.scheme)===1){_this.setState({scheme:'bright_light'});if(platformname){bridge.send(\"VKWebAppSetViewSettings\",{\"status_bar_style\":\"dark\",\"action_bar_color\":\"#FFFFFF\",'navigation_bar_color':\"#FFFFFF\"});}}if(Number(_this.state.account.scheme)===2){_this.setState({scheme:'space_gray'});if(platformname){bridge.send(\"VKWebAppSetViewSettings\",{\"status_bar_style\":\"light\",\"action_bar_color\":\"#19191A\",'navigation_bar_color':\"#19191A\"});}}}else{_this.setState({scheme:data.scheme});if(data.scheme==='space_gray'){if(platformname){bridge.send(\"VKWebAppSetViewSettings\",{\"status_bar_style\":\"light\",\"action_bar_color\":\"#19191A\",'navigation_bar_color':\"#19191A\"});}}else{if(platformname){bridge.send(\"VKWebAppSetViewSettings\",{\"status_bar_style\":\"dark\",\"action_bar_color\":\"#FFFFFF\",'navigation_bar_color':\"#FFFFFF\"});}}}}}).catch(function(err){_this.showErrorAlert(err);});};_this.setPopout=function(value){_this.setState({popout:value});};_this.playAudio=function(){if(!_this.audio.paused){_this.audio.pause();}else{_this.audio.volume=0.1;_this.audio.currentTime=0;var audioPromise=_this.audio.play();if(audioPromise!==undefined){audioPromise.then(function(_){// autoplay started\n}).catch(function(err){// catch dom exception\nconsole.info(err);});}}_this.setState({paused:_this.audio.paused});};return _this;}_createClass(App,[{key:\"componentDidMount\",value:function componentDidMount(){var _this2=this;this.audio=new Audio(music);this.audio.load();this.audio.loop=true;bridge.subscribe(function(_ref){var _ref$detail=_ref.detail,type=_ref$detail.type,data=_ref$detail.data;if(type==='VKWebAppAllowMessagesFromGroupResult'){fetch(_this2.state.api_url+\"method=notifications.swift&swift=on&\"+window.location.search.replace('?','')).then(function(res){return res.json();}).then(function(data){if(data){_this2.setState({switchKeys:true});}}).catch(function(err){_this2.showErrorAlert();});}if(type==='VKWebAppAllowMessagesFromGroupFailed'){fetch(_this2.state.api_url+\"method=notifications.swift&swift=off&\"+window.location.search.replace('?','')).then(function(res){return res.json();}).then(function(data){if(data){_this2.setState({switchKeys:false});}}).catch(function(err){_this2.showErrorAlert();});}if(type==='VKWebAppViewHide'){console.log('closing...');}if(type==='VKWebAppUpdateConfig'){// console.log(data)\n_this2.setState({default_scheme:data.scheme});if(!isEmpty(_this2.state.account)){if(Number(_this2.state.account.scheme)===0){_this2.setState({scheme:data.scheme});}if(Number(_this2.state.account.scheme)===1){_this2.setState({scheme:'bright_light'});if(platformname){bridge.send(\"VKWebAppSetViewSettings\",{\"status_bar_style\":\"dark\",\"action_bar_color\":\"#FFFFFF\",'navigation_bar_color':\"#FFFFFF\"});}}if(Number(_this2.state.account.scheme)===2){_this2.setState({scheme:'space_gray'});if(platformname){bridge.send(\"VKWebAppSetViewSettings\",{\"status_bar_style\":\"light\",\"action_bar_color\":\"#19191A\",'navigation_bar_color':\"#19191A\"});}}}else{_this2.setState({scheme:data.scheme});if(data.scheme==='space_gray'){if(platformname){bridge.send(\"VKWebAppSetViewSettings\",{\"status_bar_style\":\"light\",\"action_bar_color\":\"#19191A\",'navigation_bar_color':\"#19191A\"});}}else{if(platformname){bridge.send(\"VKWebAppSetViewSettings\",{\"status_bar_style\":\"dark\",\"action_bar_color\":\"#FFFFFF\",'navigation_bar_color':\"#FFFFFF\"});}}}}});fetch(this.state.api_url+\"method=account.get&\"+window.location.search.replace('?','')).then(function(res){return res.json();}).then(function(data){if(data.result){_this2.setState({account:data.response,popout:null,switchKeys:data.response.noti});if(Number(_this2.state.account.scheme)===1){_this2.setState({scheme:'bright_light'});if(platformname){bridge.send(\"VKWebAppSetViewSettings\",{\"status_bar_style\":\"dark\",\"action_bar_color\":\"#FFFFFF\",'navigation_bar_color':\"#FFFFFF\"});}}if(Number(_this2.state.account.scheme)===2){_this2.setState({scheme:'space_gray'});if(platformname){bridge.send(\"VKWebAppSetViewSettings\",{\"status_bar_style\":\"light\",\"action_bar_color\":\"#19191A\",'navigation_bar_color':\"#19191A\"});}}if(_this2.state.account.is_first_start){_this2.setState({activeStory:'start'});}}else{_this2.setPopout(/*#__PURE__*/React.createElement(Alert,{actions:[{title:'Повторить',autoclose:true,action:function action(){return _this2.componentDidMount();}}],onClose:function onClose(){_this2.setPopout(null);_this2.componentDidMount();}},/*#__PURE__*/React.createElement(\"h2\",null,\"\\u041E\\u0448\\u0438\\u0431\\u043A\\u0430\"),/*#__PURE__*/React.createElement(\"p\",null,data.error.message)));}}).catch(function(err){_this2.showErrorAlert(err);});}},{key:\"showAlert\",value:function showAlert(title,text){this.setState({popout:/*#__PURE__*/React.createElement(Alert,{actions:[{title:'Закрыть',autoclose:true,style:'cancel'}],onClose:this.setPopout(null)},/*#__PURE__*/React.createElement(\"h2\",null,title),/*#__PURE__*/React.createElement(\"p\",null,text))});}},{key:\"deleteStats\",value:function deleteStats(){var _this3=this;this.setState({popout:/*#__PURE__*/React.createElement(ScreenSpinner,null)});fetch(this.state.api_url+\"method=delete.stats&\"+window.location.search.replace('?','')).then(function(res){return res.json();}).then(function(data){if(data.response){_this3.setState({snackbar:/*#__PURE__*/React.createElement(Snackbar,{layout:\"vertical\",onClose:function onClose(){return _this3.setState({snackbar:null});},before:/*#__PURE__*/React.createElement(Avatar,{size:24,style:blueBackground},/*#__PURE__*/React.createElement(Icon16CheckCircle,{fill:\"#fff\",width:14,height:14}))},\"\\u0421\\u0442\\u0430\\u0442\\u0438\\u0441\\u0442\\u0438\\u043A\\u0430 \\u043F\\u0440\\u043E\\u0444\\u0438\\u043B\\u044F \\u0441\\u0431\\u0440\\u043E\\u0448\\u0435\\u043D\\u0430\"),popout:null});_this3.LoadProfile();window.history.back();}else{_this3.showAlert('Ошибка',data.error_text);}}).catch(function(err){_this3.showErrorAlert();});}},{key:\"showErrorAlert\",value:function showErrorAlert(){var _this4=this;var error=arguments.length>0&&arguments[0]!==undefined?arguments[0]:null;this.setPopout(/*#__PURE__*/React.createElement(Alert,{actions:[{title:'Отмена',autoclose:true,mode:'cancel'}],onClose:function onClose(){return _this4.setPopout(null);}},/*#__PURE__*/React.createElement(\"h2\",null,\"\\u041E\\u0448\\u0438\\u0431\\u043A\\u0430\"),error?/*#__PURE__*/React.createElement(\"p\",null,error):/*#__PURE__*/React.createElement(\"p\",null,\"\\u0427\\u0442\\u043E-\\u0442\\u043E \\u043F\\u043E\\u0448\\u043B\\u043E \\u043D\\u0435 \\u0442\\u0430\\u043A, \\u043F\\u043E\\u043F\\u0440\\u043E\\u0431\\u0443\\u0439\\u0442\\u0435 \\u0441\\u043D\\u043E\\u0432\\u0430!\")));}},{key:\"render\",value:function render(){var _this5=this;return/*#__PURE__*/React.createElement(ConfigProvider,{isWebView:platformname,scheme:this.state.scheme},/*#__PURE__*/React.createElement(Epic,{activeStory:this.state.activeStory,tabbar:this.state.need_epic&&/*#__PURE__*/React.createElement(Tabbar,null,/*#__PURE__*/React.createElement(TabbarItem,{onClick:function onClick(e){_this5.setState({activeStory:e.currentTarget.dataset.story});},selected:this.state.activeStory==='questions',\"data-story\":\"questions\",text:\"\\u0412\\u043E\\u043F\\u0440\\u043E\\u0441\\u044B\"},/*#__PURE__*/React.createElement(Icon28ArticleOutline,null)),/*#__PURE__*/React.createElement(TabbarItem,{onClick:function onClick(e){_this5.setState({activeStory:e.currentTarget.dataset.story});},selected:this.state.activeStory==='top',\"data-story\":\"top\",text:\"\\u0422\\u043E\\u043F\"},/*#__PURE__*/React.createElement(Icon28FavoriteOutline,null)),/*#__PURE__*/React.createElement(TabbarItem,{onClick:function onClick(e){_this5.setState({activeStory:e.currentTarget.dataset.story});},selected:this.state.activeStory==='profile',\"data-story\":\"profile\",text:\"\\u041F\\u0440\\u043E\\u0444\\u0438\\u043B\\u044C\"},/*#__PURE__*/React.createElement(Icon28Profile,null)))},/*#__PURE__*/React.createElement(Questions,{id:\"questions\",this:this,scheme:this.state.scheme,reloadProfile:this.LoadProfile,account:this.state.account,popout:this.state.popout}),/*#__PURE__*/React.createElement(Top,{id:\"top\",this:this,scheme:this.state.scheme,account:this.state.account,popout:this.state.popout}),/*#__PURE__*/React.createElement(Notification,{id:\"notif\",this:this,scheme:this.state.scheme,reloadProfile:this.LoadProfile,account:this.state.account,popout:this.state.popout}),/*#__PURE__*/React.createElement(Profile,{id:\"profile\",this:this,reloadProfile:this.LoadProfile,scheme:this.state.scheme,default_scheme:this.state.default_scheme,account:this.state.account,popout:this.state.popout}),/*#__PURE__*/React.createElement(Start,{id:\"start\",this:this,reloadProfile:this.LoadProfile,scheme:this.state.scheme,account:this.state.account,popout:this.state.popout})));}}]);return App;}(React.Component);export default App;","map":{"version":3,"sources":["C:/Users/rshub/Desktop/Road-to-Jedi/mobile-road/src/App.js"],"names":["React","bridge","music","Alert","Avatar","ScreenSpinner","Snackbar","Tabbar","TabbarItem","Epic","ConfigProvider","Questions","Top","Notification","Profile","Start","Icon28Profile","Icon16CheckCircle","Icon28ArticleOutline","Icon28FavoriteOutline","platformname","test","navigator","userAgent","blueBackground","backgroundColor","isEmpty","obj","key","App","props","state","account","activeStory","scheme","default_scheme","api_url","popout","snackbar","switchKeys","need_epic","changeData","name","value","setState","LoadProfile","fetch","window","location","search","replace","then","res","json","data","result","response","noti","Number","send","catch","err","showErrorAlert","setPopout","playAudio","audio","paused","pause","volume","currentTime","audioPromise","play","undefined","_","console","info","Audio","load","loop","subscribe","detail","type","log","is_first_start","title","autoclose","action","componentDidMount","error","message","text","style","history","back","showAlert","error_text","mode","e","currentTarget","dataset","story","Component"],"mappings":"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","sourcesContent":["import React from 'react'; // React\nimport bridge from '@vkontakte/vk-bridge'; // VK Brige\n\nimport music from './music/Soloriver.mp3';\n\nimport { \n  Alert,\n  Avatar,\n  ScreenSpinner,\n  Snackbar,\n  Tabbar,\n  TabbarItem,\n  Epic,\n  ConfigProvider,\n  } from '@vkontakte/vkui';\n\nimport '@vkontakte/vkui/dist/vkui.css';\nimport './style.css'\n// Импортируем панели\nimport Questions from './panels/questions/main'\nimport Top from './panels/topUsers/main'\nimport Notification from './panels/notify/main'\nimport Profile from './panels/Profile/main'\nimport Start from './panels/Start/main'\n\nimport Icon28Profile from '@vkontakte/icons/dist/28/profile';\nimport Icon16CheckCircle from '@vkontakte/icons/dist/16/check_circle';\nimport Icon28ArticleOutline from '@vkontakte/icons/dist/28/article_outline';\nimport Icon28FavoriteOutline from '@vkontakte/icons/dist/28/favorite_outline';\n\n// const queryString = require('query-string');\nconst platformname = (/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent));\n// const parsedHash = queryString.parse(window.location.search.replace('?', ''));\n// const hash = queryString.parse(window.location.hash);\n\n\nconst blueBackground = {\n  backgroundColor: 'var(--accent)'\n};\nfunction isEmpty(obj) {\n  for (let key in obj) {\n    // если тело цикла начнет выполняться - значит в объекте есть свойства\n    return false;\n  }\n  return true;\n}\nclass App extends React.Component {\n    constructor(props) {\n        super(props);\n        this.state = {\n            account:[],\n            activeStory: 'questions',\n            scheme: \"bright_light\",\n            default_scheme: \"bright_light\",\n            api_url: \"https://xelene.ru/road/php/index.php?\",\n            popout: <ScreenSpinner/>,\n            snackbar: null,\n            switchKeys: false,\n            need_epic: true,\n\n        };\n        this.changeData = (name,value) => {\n          this.setState({ [name]: value });\n        }\n        this.LoadProfile = () => {\n          fetch(this.state.api_url + \"method=account.get&\" + window.location.search.replace('?', ''))\n          .then(res => res.json())\n          .then(data => {\n          if(data.result) {\n              this.setState({account: data.response,popout: null, switchKeys: data.response.noti})\n              if(!isEmpty(this.state.account)){\n                if(Number(this.state.account.scheme) === 0){\n                  this.setState({scheme: this.state.default_scheme})\n                  if(this.state.default_scheme === 'bright_light'){\n                    if(platformname){\n                      bridge.send(\"VKWebAppSetViewSettings\", {\"status_bar_style\": \"dark\", \"action_bar_color\": \"#FFFFFF\",'navigation_bar_color': \"#FFFFFF\"});\n                    }\n                  }\n                  if(this.state.default_scheme === 'space_gray'){\n                    if(platformname){\n                      bridge.send(\"VKWebAppSetViewSettings\", {\"status_bar_style\": \"light\", \"action_bar_color\": \"#19191A\",'navigation_bar_color': \"#19191A\"});\n                    }\n                  }\n                }\n                if(Number(this.state.account.scheme) === 1){\n                  this.setState({scheme: 'bright_light'})\n                  if(platformname){\n                    bridge.send(\"VKWebAppSetViewSettings\", {\"status_bar_style\": \"dark\", \"action_bar_color\": \"#FFFFFF\",'navigation_bar_color': \"#FFFFFF\"});\n                  }\n                  \n                }\n                if(Number(this.state.account.scheme) === 2){\n                  this.setState({scheme: 'space_gray'})\n                  if(platformname){\n                    bridge.send(\"VKWebAppSetViewSettings\", {\"status_bar_style\": \"light\", \"action_bar_color\": \"#19191A\",'navigation_bar_color': \"#19191A\"});\n                  }\n                }\n              }else{\n                this.setState({scheme: data.scheme})\n                if(data.scheme === 'space_gray'){\n                  if(platformname){\n                    bridge.send(\"VKWebAppSetViewSettings\", {\"status_bar_style\": \"light\", \"action_bar_color\": \"#19191A\",'navigation_bar_color': \"#19191A\"});\n                  }\n                }else{\n                  if(platformname){\n                    bridge.send(\"VKWebAppSetViewSettings\", {\"status_bar_style\": \"dark\", \"action_bar_color\": \"#FFFFFF\",'navigation_bar_color': \"#FFFFFF\"});\n                  }\n                }\n                }\n            }})\n          .catch(err => {\n            this.showErrorAlert(err)\n    \n          })\n        }\n        this.setPopout = (value) => {\n          this.setState({popout: value})\n        }\n          this.playAudio = () => {\n            if(!this.audio.paused){\n              this.audio.pause()\n            } else {\n              this.audio.volume = 0.1;\n              this.audio.currentTime = 0;\n              const audioPromise = this.audio.play()\n              if (audioPromise !== undefined) {\n              audioPromise\n                .then(_ => {\n                // autoplay started\n                \n                })\n                .catch(err => {\n                // catch dom exception\n                console.info(err)\n                })\n              }\n            }\n            this.setState({paused: this.audio.paused})\n          }\n    }\n    \n    componentDidMount() {\n      this.audio = new Audio(music)\n      this.audio.load()\n      this.audio.loop = true;\n      bridge.subscribe(({ detail: { type, data }}) => { \n        if(type === 'VKWebAppAllowMessagesFromGroupResult') {\n          fetch(this.state.api_url + \"method=notifications.swift&swift=on&\" + window.location.search.replace('?', ''))\n            .then(res => res.json())\n            .then(data => {\n              if(data) {\n                this.setState({switchKeys: true})\n              }\n            })\n            .catch(err => {\n              this.showErrorAlert()\n            })\n        }\n        if(type === 'VKWebAppAllowMessagesFromGroupFailed') {\n          fetch(this.state.api_url + \"method=notifications.swift&swift=off&\" + window.location.search.replace('?', ''))\n            .then(res => res.json())\n            .then(data => {\n              if(data) {\n                this.setState({switchKeys: false})\n              }\n            })\n            .catch(err => {\n              this.showErrorAlert()\n            })\n        }\n        if(type === 'VKWebAppViewHide') {\n          console.log('closing...')\n        }\n\t\t\t  if (type === 'VKWebAppUpdateConfig') {\n          // console.log(data)\n          this.setState({default_scheme: data.scheme});\n          if(!isEmpty(this.state.account)){\n            if(Number(this.state.account.scheme) === 0){\n              this.setState({scheme: data.scheme})\n            }\n            if(Number(this.state.account.scheme) === 1){\n              this.setState({scheme: 'bright_light'})\n              if(platformname){\n                bridge.send(\"VKWebAppSetViewSettings\", {\"status_bar_style\": \"dark\", \"action_bar_color\": \"#FFFFFF\",'navigation_bar_color': \"#FFFFFF\"});\n              }\n            }\n            if(Number(this.state.account.scheme) === 2){\n              this.setState({scheme: 'space_gray'})\n              if(platformname){\n                bridge.send(\"VKWebAppSetViewSettings\", {\"status_bar_style\": \"light\", \"action_bar_color\": \"#19191A\",'navigation_bar_color': \"#19191A\"});\n              }\n            }\n          }else{\n            this.setState({scheme: data.scheme})\n            if(data.scheme === 'space_gray'){\n              if(platformname){\n                bridge.send(\"VKWebAppSetViewSettings\", {\"status_bar_style\": \"light\", \"action_bar_color\": \"#19191A\",'navigation_bar_color': \"#19191A\"});\n              }\n            }else{\n              if(platformname){\n                bridge.send(\"VKWebAppSetViewSettings\", {\"status_bar_style\": \"dark\", \"action_bar_color\": \"#FFFFFF\",'navigation_bar_color': \"#FFFFFF\"});\n              }\n            }\n            }\n          }\n        })\n        fetch(this.state.api_url + \"method=account.get&\" + window.location.search.replace('?', ''))\n        .then(res => res.json())\n        .then(data => {\n          if(data.result) {\n            this.setState({account: data.response, popout: null, switchKeys: data.response.noti})\n              if(Number(this.state.account.scheme) === 1){\n                this.setState({scheme: 'bright_light'})\n                if(platformname){\n                  bridge.send(\"VKWebAppSetViewSettings\", {\"status_bar_style\": \"dark\", \"action_bar_color\": \"#FFFFFF\", 'navigation_bar_color': \"#FFFFFF\"});\n                }\n              }\n              if(Number(this.state.account.scheme) === 2){\n                this.setState({scheme: 'space_gray'})\n                if(platformname){\n                  bridge.send(\"VKWebAppSetViewSettings\", {\"status_bar_style\": \"light\", \"action_bar_color\": \"#19191A\",'navigation_bar_color': \"#19191A\"});\n                }\n              }\n            if(this.state.account.is_first_start){\n              this.setState({activeStory: 'start'});\n            }\n          } else {\n            this.setPopout(\n              <Alert\n        actions={[{\n          title: 'Повторить',\n          autoclose: true,\n          action: () => this.componentDidMount()\n        }]}\n        onClose={() => {this.setPopout(null);this.componentDidMount()}}\n      >\n        <h2>Ошибка</h2>\n        <p>{data.error.message}</p>\n            </Alert>)\n          }\n        })\n        .catch(err => {\n          this.showErrorAlert(err)\n        })\n    }\n\n    showAlert(title, text) {\n      this.setState({\n        popout: \n          <Alert\n            actions={[{\n              title: 'Закрыть',\n              autoclose: true,\n              style: 'cancel'\n            }]}\n            onClose={this.setPopout(null)}\n          >\n            <h2>{title}</h2>\n            <p>{text}</p>\n        </Alert>\n      })\n    }\n\n\n    deleteStats() {\n      this.setState({popout: <ScreenSpinner/>})\n      fetch(this.state.api_url + \"method=delete.stats&\" + window.location.search.replace('?', ''))\n      .then(res => res.json())\n      .then(data => {\n        if(data.response) {\n          this.setState({snackbar: \n            <Snackbar\n              layout=\"vertical\"\n              onClose={() => this.setState({ snackbar: null })}\n              before={<Avatar size={24} style={blueBackground}><Icon16CheckCircle fill=\"#fff\" width={14} height={14} /></Avatar>}\n            >\n              Статистика профиля сброшена\n            </Snackbar>, popout: null\n          })\n          this.LoadProfile()\n          window.history.back()\n        } else {\n          this.showAlert('Ошибка', data.error_text);\n        }\n      })\n      .catch(err => {\n        this.showErrorAlert()\n      })\n    }\n    showErrorAlert(error=null){\n      this.setPopout(\n        <Alert\n            actions={[{\n            title: 'Отмена',\n            autoclose: true,\n            mode: 'cancel'\n            }]}\n            onClose={() => this.setPopout(null)}\n        >\n          <h2>Ошибка</h2>\n          {error ? <p>{error}</p> : <p>Что-то пошло не так, попробуйте снова!</p>}\n        </Alert>\n    )\n  }\n\n    \n    render() {\n        return(\n            <ConfigProvider isWebView={platformname} scheme={this.state.scheme}> \n              <Epic activeStory={this.state.activeStory}\n              tabbar={\n                  this.state.need_epic &&\n                  <Tabbar>\n                    <TabbarItem\n                      onClick={(e) => {this.setState({activeStory: e.currentTarget.dataset.story})}} \n                      selected={this.state.activeStory === 'questions'}\n                      data-story=\"questions\"\n                      text='Вопросы'\n                    ><Icon28ArticleOutline/></TabbarItem>\n                    <TabbarItem\n                      onClick={(e) => {this.setState({activeStory: e.currentTarget.dataset.story})}} \n                      selected={this.state.activeStory === 'top'}\n                      data-story=\"top\"\n                      text='Топ'\n                    ><Icon28FavoriteOutline /></TabbarItem>\n                    <TabbarItem\n                      onClick={(e) => {this.setState({activeStory: e.currentTarget.dataset.story})}} \n                      selected={this.state.activeStory === 'profile'}\n                      data-story=\"profile\"\n                      text='Профиль'\n                    ><Icon28Profile /></TabbarItem>\n                  </Tabbar>\n                }>\n                <Questions \n                id='questions'\n                this={this}\n                scheme={this.state.scheme}\n                reloadProfile={this.LoadProfile}\n                account={this.state.account}\n                popout={this.state.popout} />\n\n                <Top \n                id='top'\n                this={this}\n                scheme={this.state.scheme}\n                account={this.state.account}\n                popout={this.state.popout} />\n\n                <Notification \n                id=\"notif\"\n                this={this}\n                scheme={this.state.scheme}\n                reloadProfile={this.LoadProfile}\n                account={this.state.account}\n                popout={this.state.popout}\n                />\n\n                <Profile \n                id=\"profile\"\n                this={this}\n                reloadProfile={this.LoadProfile}\n                scheme={this.state.scheme}\n                default_scheme={this.state.default_scheme}\n                account={this.state.account}\n                popout={this.state.popout} />\n                \n                <Start \n                id=\"start\"\n                this={this}\n                reloadProfile={this.LoadProfile}\n                scheme={this.state.scheme}\n                account={this.state.account}\n                popout={this.state.popout} />\n              </Epic>\n            </ConfigProvider>\n        );\n    }\n}\n\nexport default App;"]},"metadata":{},"sourceType":"module"}