{"ast":null,"code":"import _toConsumableArray from\"C:\\\\Users\\\\rshub\\\\Desktop\\\\Road-to-Jedi\\\\mobile-road\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/toConsumableArray\";import _defineProperty from\"C:\\\\Users\\\\rshub\\\\Desktop\\\\Road-to-Jedi\\\\mobile-road\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/defineProperty\";import _classCallCheck from\"C:\\\\Users\\\\rshub\\\\Desktop\\\\Road-to-Jedi\\\\mobile-road\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/classCallCheck\";import _createClass from\"C:\\\\Users\\\\rshub\\\\Desktop\\\\Road-to-Jedi\\\\mobile-road\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/createClass\";import _inherits from\"C:\\\\Users\\\\rshub\\\\Desktop\\\\Road-to-Jedi\\\\mobile-road\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/inherits\";import _createSuper from\"C:\\\\Users\\\\rshub\\\\Desktop\\\\Road-to-Jedi\\\\mobile-road\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/createSuper\";import React from'react';// React\nimport bridge from'@vkontakte/vk-bridge';// VK Brige\nimport{Alert,Avatar,View,ScreenSpinner,ModalRoot,ModalCard,Input}from'@vkontakte/vkui';import'@vkontakte/vkui/dist/vkui.css';import'../../style.css';// –ò–º–ø–æ—Ä—Ç–∏—Ä—É–µ–º –ø–∞–Ω–µ–ª–∏\nimport Notif from'./panels/notif';import Tiket from'../../components/tiket';import OtherProfile from'../../components/other_profile';//–ò–º–ø–æ—Ä—Ç–∏—Ä—É–µ–º –º–æ–¥–∞–ª—å–Ω—ã–µ –∫–∞—Ä—Ç–æ—á–∫–∏\nimport ModalPrometay from'../../Modals/Prometay';import ModalDonut from'../../Modals/Donut';import ModalComment from'../../Modals/Comment';// const queryString = require('query-string');\n// const platformname = (/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent));\n// const parsedHash = queryString.parse(window.location.search.replace('?', ''));\n// const hash = queryString.parse(window.location.hash);\nvar ignore_back=false;var Notify=/*#__PURE__*/function(_React$Component){_inherits(Notify,_React$Component);var _super=_createSuper(Notify);function Notify(props){var _this;_classCallCheck(this,Notify);_this=_super.call(this,props);_this.state={api_url:\"https://xelene.ru/road/php/index.php?\",activePanel:'notif',activeModal:null,modalHistory:[],popout:_this.props.popout,ticket_id:null,history:['notif'],active_other_profile:0,other_profile:null,ban_reason:\"\",comment:\"\",transfer:{'avatar':'','comment':''}};_this.changeData=_this.props.this.changeData;_this.ReloadProfile=_this.props.reloadProfile;// this.copy = this.props.this.copy;\n// this.recordHistory = (panel) => {\n//   this.setState({history: [...this.state.history, panel]})\n// }\n_this.setPopout=function(value){_this.setState({popout:value});};_this.handlePopstate=function(e){e.preventDefault();_this.goBack();};_this.goTiket=function(id){_this.setPopout(/*#__PURE__*/React.createElement(ScreenSpinner,null));_this.setState({ticket_id:id});_this.goPanel('ticket');_this.setPopout(null);};_this.onChange=function(event){var name=event.currentTarget.name;var value=event.currentTarget.value;_this.setState(_defineProperty({},name,value));};_this.goOtherProfile=function(id){_this.setState({active_other_profile:id});_this.goPanel(\"other_profile\");};_this.openMoneyTransfer=function(avatar,text,comment){_this.setState({transfer:{avatar:avatar,text:text,comment:comment?comment:'–ê–≥–µ–Ω—Ç –Ω–µ –æ—Å—Ç–∞–≤–∏–ª –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏—è üò¢'}});_this.setActiveModal('transfer');};_this.modalBack=function(){_this.setActiveModal(_this.state.modalHistory[_this.state.modalHistory.length-2]);};_this.goBack=function(){if(!ignore_back){ignore_back=true;var history=_this.state.history;if(history.length===1){_this.props.this.changeData(\"activeStory\",'profile');}else if(history.length>1){history.pop();if(_this.state.activePanel==='notif'){bridge.send('VKWebAppDisableSwipeBack');}_this.setState({activePanel:history[history.length-1]});// if(history[history.length - 1] === 'ticket'){\n//   this.changeData('need_epic', false)\n// } else{\n//   this.changeData('need_epic', true)\n// }\n_this.setPopout(/*#__PURE__*/React.createElement(ScreenSpinner,null));setTimeout(function(){_this.setPopout(null);},500);}setTimeout(function(){ignore_back=false;},500);}else{var _history=_this.state.history;window.history.pushState({panel:_history[_history.length-1]},_history[_history.length-1]);}};_this.goPanel=function(panel){var history=_this.state.history.slice();history.push(panel);window.history.pushState({panel:panel},panel);if(panel==='notif'){bridge.send('VKWebAppEnableSwipeBack');}_this.setState({history:history,activePanel:panel});// if(panel === 'ticket'){\n//   this.changeData('need_epic', false)\n// } else{\n//   this.changeData('need_epic', true)\n// }\n};_this.setActiveModal=function(activeModal){activeModal=activeModal||null;var modalHistory=_this.state.modalHistory?_toConsumableArray(_this.state.modalHistory):[];if(activeModal===null){modalHistory=[];}else if(modalHistory.indexOf(activeModal)!==-1){modalHistory=modalHistory.splice(0,modalHistory.indexOf(activeModal)+1);}else{modalHistory.push(activeModal);}_this.setState({activeModal:activeModal,modalHistory:modalHistory});};_this.showAlert=function(title,text){_this.setState({popout:/*#__PURE__*/React.createElement(Alert,{actions:[{title:'–ó–∞–∫—Ä—ã—Ç—å',autoclose:true,mode:'cancel'}],onClose:function onClose(){return _this.setPopout(null);}},/*#__PURE__*/React.createElement(\"h2\",null,title),/*#__PURE__*/React.createElement(\"p\",null,text))});};_this.showErrorAlert=function(){var error=arguments.length>0&&arguments[0]!==undefined?arguments[0]:null;var action=arguments.length>1&&arguments[1]!==undefined?arguments[1]:null;_this.setPopout(/*#__PURE__*/React.createElement(Alert,{actions:[{title:'–û—Ç–º–µ–Ω–∞',autoclose:true,mode:'cancel',action:action}],onClose:function onClose(){return _this.setPopout(null);}},/*#__PURE__*/React.createElement(\"h2\",null,\"\\u041E\\u0448\\u0438\\u0431\\u043A\\u0430\"),error?/*#__PURE__*/React.createElement(\"p\",null,error):/*#__PURE__*/React.createElement(\"p\",null,\"\\u0427\\u0442\\u043E-\\u0442\\u043E \\u043F\\u043E\\u0448\\u043B\\u043E \\u043D\\u0435 \\u0442\\u0430\\u043A, \\u043F\\u043E\\u043F\\u0440\\u043E\\u0431\\u0443\\u0439\\u0442\\u0435 \\u0441\\u043D\\u043E\\u0432\\u0430!\")));};return _this;}_createClass(Notify,[{key:\"userBan\",value:function userBan(user_id,text){var _this2=this;this.setPopout(/*#__PURE__*/React.createElement(ScreenSpinner,null));fetch(this.state.api_url+\"method=account.ban&\"+window.location.search.replace('?',''),{method:'post',headers:{\"Content-type\":\"application/json; charset=UTF-8\"},// signal: controllertime.signal,\nbody:JSON.stringify({'agent_id':user_id,'banned':true,'reason':text})}).then(function(res){return res.json();}).then(function(data){if(data.result){_this2.setActiveModal(null);_this2.showAlert('–£—Å–ø–µ—Ö','–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –∑–∞–±–∞–Ω–µ–Ω');_this2.setPopout(null);}else{_this2.showErrorAlert(data.error.message);}}).catch(function(err){_this2.showErrorAlert('–û—à–∏–±–∫–∞ –∑–∞–ø—Ä–æ—Å–∞. –ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –ø–æ–ø—Ä–æ–±—É–π—Ç–µ –ø–æ–∑–∂–µ',function(){_this2.changeData('activeStory','disconnect');});});}},{key:\"componentDidMount\",value:function componentDidMount(){bridge.send('VKWebAppEnableSwipeBack');window.addEventListener('popstate',this.handlePopstate);}},{key:\"componentWillUnmount\",value:function componentWillUnmount(){bridge.send('VKWebAppDisableSwipeBack');window.removeEventListener('popstate',this.handlePopstate);}},{key:\"render\",value:function render(){var _this3=this;var modal=/*#__PURE__*/React.createElement(ModalRoot,{activeModal:this.state.activeModal},/*#__PURE__*/React.createElement(ModalPrometay,{id:\"prom\",onClose:function onClose(){return _this3.setActiveModal(null);},action:function action(){return _this3.setActiveModal(null);}}),/*#__PURE__*/React.createElement(ModalDonut,{id:\"donut\",onClose:function onClose(){return _this3.setActiveModal(null);},action:function action(){return _this3.setActiveModal(null);}}),/*#__PURE__*/React.createElement(ModalCard,{id:\"ban_user\",onClose:function onClose(){return _this3.setActiveModal(null);},icon:/*#__PURE__*/React.createElement(Avatar,{src:this.state.other_profile?this.state.other_profile['avatar']['url']:null,size:72}),header:\"\\u0417\\u0430\\u0431\\u0430\\u043D\\u0438\\u0442\\u044C \\u043F\\u043E\\u043B\\u044C\\u0437\\u043E\\u0432\\u0430\\u0442\\u0435\\u043B\\u044F\",actions:[{title:'–ó–∞–±–∞–Ω–∏—Ç—å! ü§¨',mode:'secondary',action:function action(){_this3.userBan(_this3.state.other_profile?_this3.state.other_profile['id']:0,_this3.state.ban_reason);console.log(_this3.state.other_profile['id']);}}]},/*#__PURE__*/React.createElement(Input,{disabled:true,value:this.state.other_profile?this.state.other_profile['id']<0?-this.state.other_profile['id']:this.state.other_profile['id']:null}),/*#__PURE__*/React.createElement(\"br\",null),/*#__PURE__*/React.createElement(Input,{maxLength:\"100\",name:\"ban_reason\",onChange:function onChange(e){return _this3.onChange(e);},placeholder:\"\\u0412\\u0432\\u0435\\u0434\\u0438\\u0442\\u0435 \\u043F\\u0440\\u0438\\u0447\\u0438\\u043D\\u0443 \\u0431\\u0430\\u043D\\u0430\",value:this.state.ban_reason})),/*#__PURE__*/React.createElement(ModalCard,{id:\"transfer\",onClose:function onClose(){return _this3.setActiveModal(null);},icon:/*#__PURE__*/React.createElement(Avatar,{src:this.state.transfer.avatar,size:72}),header:\"\\u041F\\u0435\\u0440\\u0435\\u0432\\u043E\\u0434 \\u043C\\u043E\\u043D\\u0435\\u0442\\u043E\\u043A\",caption:this.state.transfer.comment,actions:[{title:'–ó–∞–∫—Ä—ã—Ç—å',mode:'secondary',action:function action(){_this3.setActiveModal(null);}}]}),/*#__PURE__*/React.createElement(ModalComment,{id:\"comment\",onClose:this.modalBack,comment:this.state.comment}));return/*#__PURE__*/React.createElement(View,{id:this.props.id,activePanel:this.state.activePanel,modal:modal,popout:this.state.popout,history:this.state.history,onSwipeBack:function onSwipeBack(){return window.history.back();}},/*#__PURE__*/React.createElement(Notif,{id:\"notif\",this:this}),/*#__PURE__*/React.createElement(Tiket,{id:\"ticket\",this:this,ticket_id:this.state.ticket_id,account:this.props.account}),/*#__PURE__*/React.createElement(OtherProfile,{id:\"other_profile\",this:this,agent_id:this.state.active_other_profile,account:this.props.account}));}}]);return Notify;}(React.Component);export{Notify as default};","map":{"version":3,"sources":["C:/Users/rshub/Desktop/Road-to-Jedi/mobile-road/src/panels/notify/main.js"],"names":["React","bridge","Alert","Avatar","View","ScreenSpinner","ModalRoot","ModalCard","Input","Notif","Tiket","OtherProfile","ModalPrometay","ModalDonut","ModalComment","ignore_back","Notify","props","state","api_url","activePanel","activeModal","modalHistory","popout","ticket_id","history","active_other_profile","other_profile","ban_reason","comment","transfer","changeData","this","ReloadProfile","reloadProfile","setPopout","value","setState","handlePopstate","e","preventDefault","goBack","goTiket","id","goPanel","onChange","event","name","currentTarget","goOtherProfile","openMoneyTransfer","avatar","text","setActiveModal","modalBack","length","pop","send","setTimeout","window","pushState","panel","slice","push","indexOf","splice","showAlert","title","autoclose","mode","showErrorAlert","error","action","user_id","fetch","location","search","replace","method","headers","body","JSON","stringify","then","res","json","data","result","message","catch","err","addEventListener","removeEventListener","modal","userBan","console","log","back","account","Component"],"mappings":"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","sourcesContent":["import React from 'react'; // React\r\nimport bridge from '@vkontakte/vk-bridge'; // VK Brige\r\n\r\nimport { \r\n  Alert,\r\n  Avatar,\r\n  View,\r\n  ScreenSpinner,\r\n  ModalRoot,\r\n  ModalCard,\r\n  Input,\r\n\r\n  } from '@vkontakte/vkui';\r\n\r\nimport '@vkontakte/vkui/dist/vkui.css';\r\nimport '../../style.css'\r\n// –ò–º–ø–æ—Ä—Ç–∏—Ä—É–µ–º –ø–∞–Ω–µ–ª–∏\r\nimport Notif from './panels/notif';\r\nimport Tiket from '../../components/tiket';\r\nimport OtherProfile from '../../components/other_profile'\r\n\r\n//–ò–º–ø–æ—Ä—Ç–∏—Ä—É–µ–º –º–æ–¥–∞–ª—å–Ω—ã–µ –∫–∞—Ä—Ç–æ—á–∫–∏\r\nimport ModalPrometay from '../../Modals/Prometay';\r\nimport ModalDonut from '../../Modals/Donut'\r\nimport ModalComment from '../../Modals/Comment';\r\n\r\n\r\n\r\n// const queryString = require('query-string');\r\n// const platformname = (/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent));\r\n// const parsedHash = queryString.parse(window.location.search.replace('?', ''));\r\n// const hash = queryString.parse(window.location.hash);\r\nvar ignore_back = false;\r\n\r\nexport default class Notify extends React.Component {\r\n    constructor(props) {\r\n        super(props);\r\n        this.state = {\r\n            api_url: \"https://xelene.ru/road/php/index.php?\",\r\n            activePanel: 'notif',\r\n            activeModal: null,\r\n            modalHistory: [],\r\n            popout: this.props.popout,\r\n            ticket_id: null,\r\n            history: ['notif'],\r\n            active_other_profile: 0,\r\n            other_profile: null,\r\n            ban_reason: \"\",\r\n            comment: \"\",\r\n            transfer: {\r\n              'avatar': '',\r\n              'comment': ''\r\n            },\r\n        \r\n\r\n        }\r\n        this.changeData = this.props.this.changeData;\r\n        this.ReloadProfile = this.props.reloadProfile;\r\n        // this.copy = this.props.this.copy;\r\n        // this.recordHistory = (panel) => {\r\n        //   this.setState({history: [...this.state.history, panel]})\r\n        // }\r\n        this.setPopout = (value) => {\r\n          this.setState({popout: value})\r\n        }\r\n        this.handlePopstate = (e) => {\r\n          e.preventDefault();\r\n          this.goBack()\r\n        }\r\n        this.goTiket = (id) => {\r\n          this.setPopout(<ScreenSpinner/>)\r\n          this.setState({ticket_id: id})\r\n          this.goPanel('ticket');\r\n          this.setPopout(null);\r\n        }\r\n        this.onChange = (event) => {\r\n          var name = event.currentTarget.name;\r\n          var value = event.currentTarget.value;\r\n          this.setState({ [name]: value });\r\n      }\r\n        this.goOtherProfile = (id) => {\r\n          this.setState({active_other_profile: id})\r\n          this.goPanel(\"other_profile\")\r\n        }\r\n        this.openMoneyTransfer = (avatar, text, comment) => {\r\n          this.setState({transfer: {\r\n            avatar: avatar,\r\n            text: text,\r\n            comment: comment ? comment : '–ê–≥–µ–Ω—Ç –Ω–µ –æ—Å—Ç–∞–≤–∏–ª –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏—è üò¢'\r\n          }})\r\n          this.setActiveModal('transfer')\r\n        }\r\n        this.modalBack = () => {\r\n            this.setActiveModal(this.state.modalHistory[this.state.modalHistory.length - 2]);\r\n        };\r\n        this.goBack = () => {\r\n          if(!ignore_back){\r\n            ignore_back = true;\r\n            const history = this.state.history;\r\n            if(history.length === 1) {\r\n              this.props.this.changeData(\"activeStory\", 'profile')\r\n            } else if (history.length > 1) {\r\n                history.pop()\r\n                if(this.state.activePanel === 'notif') {\r\n                  bridge.send('VKWebAppDisableSwipeBack');\r\n                }\r\n                this.setState({activePanel: history[history.length - 1]})\r\n                // if(history[history.length - 1] === 'ticket'){\r\n                //   this.changeData('need_epic', false)\r\n                // } else{\r\n                //   this.changeData('need_epic', true)\r\n                // }\r\n                this.setPopout(<ScreenSpinner />)\r\n                setTimeout(() => {\r\n                  this.setPopout(null)\r\n                }, 500)\r\n            }\r\n            setTimeout(() => {ignore_back = false;}, 500)\r\n            \r\n          }else{\r\n            const history = this.state.history;\r\n            window.history.pushState( { panel: history[history.length - 1] }, history[history.length - 1] );\r\n          }\r\n      }\r\n        this.goPanel = (panel) => {\r\n          let history = this.state.history.slice();\r\n          history.push(panel)\r\n          window.history.pushState( { panel: panel }, panel );\r\n          if(panel === 'notif') {\r\n            bridge.send('VKWebAppEnableSwipeBack');\r\n          }\r\n          this.setState({history: history, activePanel: panel})\r\n          // if(panel === 'ticket'){\r\n          //   this.changeData('need_epic', false)\r\n          // } else{\r\n          //   this.changeData('need_epic', true)\r\n          // }\r\n        }\r\n        this.setActiveModal = (activeModal) => {\r\n            activeModal = activeModal || null;\r\n            let modalHistory = this.state.modalHistory ? [...this.state.modalHistory] : [];\r\n        \r\n            if (activeModal === null) {\r\n              modalHistory = [];\r\n            } else if (modalHistory.indexOf(activeModal) !== -1) {\r\n              modalHistory = modalHistory.splice(0, modalHistory.indexOf(activeModal) + 1);\r\n            } else {\r\n              modalHistory.push(activeModal);\r\n            }\r\n        \r\n            this.setState({\r\n              activeModal: activeModal,\r\n              modalHistory: modalHistory\r\n            });\r\n          };\r\n          this.showAlert = (title, text) => {\r\n            this.setState({\r\n              popout: \r\n                <Alert\r\n                  actions={[{\r\n                    title: '–ó–∞–∫—Ä—ã—Ç—å',\r\n                    autoclose: true,\r\n                    mode: 'cancel'\r\n                  }]}\r\n                  onClose={() => this.setPopout(null)}\r\n                >\r\n                  <h2>{title}</h2>\r\n                  <p>{text}</p>\r\n              </Alert>\r\n            })\r\n          }\r\n          this.showErrorAlert = (error=null, action=null) => {\r\n            this.setPopout(\r\n              <Alert\r\n                  actions={[{\r\n                  title: '–û—Ç–º–µ–Ω–∞',\r\n                  autoclose: true,\r\n                  mode: 'cancel',\r\n                  action: action,\r\n                  }]}\r\n                  onClose={() => this.setPopout(null)}\r\n              >\r\n                <h2>–û—à–∏–±–∫–∞</h2>\r\n                {error ? <p>{error}</p> : <p>–ß—Ç–æ-—Ç–æ –ø–æ—à–ª–æ –Ω–µ —Ç–∞–∫, –ø–æ–ø—Ä–æ–±—É–π—Ç–µ —Å–Ω–æ–≤–∞!</p>}\r\n              </Alert>\r\n          )\r\n        }\r\n    }\r\n    userBan(user_id, text) {\r\n      this.setPopout(<ScreenSpinner/>)\r\n      fetch(this.state.api_url + \"method=account.ban&\" + window.location.search.replace('?', ''),\r\n      {method: 'post',\r\n      headers: {\"Content-type\": \"application/json; charset=UTF-8\"},\r\n          // signal: controllertime.signal,\r\n      body: JSON.stringify({\r\n        'agent_id': user_id,\r\n        'banned': true,\r\n        'reason': text,\r\n\r\n    })\r\n      })\r\n      .then(res => res.json())\r\n      .then(data => {\r\n        if(data.result) {\r\n          this.setActiveModal(null);\r\n          this.showAlert('–£—Å–ø–µ—Ö', '–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –∑–∞–±–∞–Ω–µ–Ω');\r\n          this.setPopout(null);\r\n        }else {\r\n          this.showErrorAlert(data.error.message)\r\n        }\r\n      })\r\n      .catch(err => {\r\n        this.showErrorAlert('–û—à–∏–±–∫–∞ –∑–∞–ø—Ä–æ—Å–∞. –ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –ø–æ–ø—Ä–æ–±—É–π—Ç–µ –ø–æ–∑–∂–µ',() => {this.changeData('activeStory', 'disconnect')})\r\n      })\r\n    }\r\n    componentDidMount(){\r\n      bridge.send('VKWebAppEnableSwipeBack');\r\n      window.addEventListener('popstate', this.handlePopstate); \r\n    }\r\n    componentWillUnmount(){\r\n      bridge.send('VKWebAppDisableSwipeBack');\r\n      window.removeEventListener('popstate', this.handlePopstate)\r\n    }\r\n    render() {\r\n        const modal = (\r\n            <ModalRoot\r\n            activeModal={this.state.activeModal}\r\n            >\r\n              <ModalPrometay\r\n              id='prom'\r\n              onClose={() => this.setActiveModal(null)}\r\n              action={() => this.setActiveModal(null)} />\r\n\r\n              <ModalDonut\r\n              id='donut'\r\n              onClose={() => this.setActiveModal(null)}\r\n              action={() => this.setActiveModal(null)} />\r\n              <ModalCard\r\n                id='ban_user'\r\n                onClose={() => this.setActiveModal(null)}\r\n                icon={<Avatar src={this.state.other_profile ? this.state.other_profile['avatar']['url'] : null} size={72} />}\r\n                header=\"–ó–∞–±–∞–Ω–∏—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è\"\r\n                actions={[{\r\n                  title: '–ó–∞–±–∞–Ω–∏—Ç—å! ü§¨',\r\n                  mode: 'secondary',\r\n                  action: () => {\r\n                    this.userBan(this.state.other_profile ? this.state.other_profile['id'] : 0, this.state.ban_reason);\r\n                    console.log(this.state.other_profile['id'])\r\n                  }\r\n                }]}\r\n              >\r\n                <Input disabled value={this.state.other_profile ? (this.state.other_profile['id'] < 0) ? -this.state.other_profile['id'] : this.state.other_profile['id'] : null}/>\r\n                <br/>\r\n                <Input maxLength=\"100\" name=\"ban_reason\" onChange={(e) => this.onChange(e)} placeholder=\"–í–≤–µ–¥–∏—Ç–µ –ø—Ä–∏—á–∏–Ω—É –±–∞–Ω–∞\" value={this.state.ban_reason} />\r\n                \r\n              </ModalCard>\r\n              \r\n              <ModalCard\r\n                id='transfer'\r\n                onClose={() => this.setActiveModal(null)}\r\n                icon={<Avatar src={this.state.transfer.avatar} size={72} />}\r\n                header='–ü–µ—Ä–µ–≤–æ–¥ –º–æ–Ω–µ—Ç–æ–∫'\r\n                caption={this.state.transfer.comment}\r\n                actions={[{\r\n                  title: '–ó–∞–∫—Ä—ã—Ç—å',\r\n                  mode: 'secondary',\r\n                  action: () => {\r\n                    this.setActiveModal(null);\r\n                  }\r\n                }]}\r\n              >\r\n              </ModalCard>\r\n              <ModalComment\r\n                id='comment'\r\n                onClose={this.modalBack}\r\n                comment={this.state.comment} />\r\n            </ModalRoot>\r\n        )\r\n        return(\r\n            <View \r\n            id={this.props.id}\r\n            activePanel={this.state.activePanel}\r\n            modal={modal}\r\n            popout={this.state.popout}\r\n            history={this.state.history}\r\n            onSwipeBack={() => window.history.back()}\r\n            >\r\n              <Notif id=\"notif\" this={this}/>\r\n              <Tiket id=\"ticket\" this={this} ticket_id={this.state.ticket_id} account={this.props.account} />\r\n              <OtherProfile id=\"other_profile\" this={this} agent_id={this.state.active_other_profile} account={this.props.account}/>\r\n            </View>   \r\n        )\r\n    }\r\n}"]},"metadata":{},"sourceType":"module"}