{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\rshub\\\\Desktop\\\\Road-to-Jedi\\\\mobile-road\\\\src\\\\panels\\\\questions\\\\panels\\\\new_tiket.js\";\nimport React from 'react';\nimport { Panel, PanelHeader, PanelHeaderButton, Button, Alert, ScreenSpinner, Input, FormLayout, Textarea } from '@vkontakte/vkui';\nimport Icon24BrowserBack from '@vkontakte/icons/dist/24/browser_back';\nexport default class NewTicket extends React.Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      api_url: \"https://xelene.ru/road/php/index.php?\",\n      title_new_tiket: '',\n      text_new_tiket: ''\n    };\n    this.sendNewTiket = this.sendNewTiket.bind(this);\n\n    this.onChange = event => {\n      var name = event.currentTarget.name;\n      var value = event.currentTarget.value;\n      this.setState({\n        [name]: value\n      });\n    };\n  }\n\n  getRandomInRange(min, max) {\n    return Math.floor(Math.random() * (max - min + 1)) + min;\n  }\n\n  sendNewTiket() {\n    this.setState({\n      popout: /*#__PURE__*/React.createElement(ScreenSpinner, {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 37,\n          columnNumber: 36\n        }\n      })\n    });\n\n    if (this.state.text_new_tiket.length > 5 || this.state.title_new_tiket.length > 5) {\n      fetch(this.state.api_url + \"method=ticket.add&\" + window.location.search.replace('?', ''), {\n        method: 'post',\n        headers: {\n          \"Content-type\": \"application/json; charset=UTF-8\"\n        },\n        // signal: controllertime.signal,\n        body: JSON.stringify({\n          'title': this.state.title_new_tiket,\n          'text': this.state.text_new_tiket,\n          'user': this.getRandomInRange(501, 624429367)\n        })\n      }).then(res => res.json()).then(data => {\n        if (data.result) {\n          fetch(this.state.api_url + \"method=tickets.get&\" + window.location.search.replace('?', ''), {\n            method: 'post',\n            headers: {\n              \"Content-type\": \"application/json; charset=UTF-8\"\n            },\n            // signal: controllertime.signal,\n            body: JSON.stringify({\n              'unanswered': 1\n            })\n          }).then(res => res.json()).then(data => {\n            if (data.result) {\n              this.setState({\n                tiket_all: data.response,\n                popout: null,\n                title_new_tiket: \"\",\n                text_new_tiket: \"\"\n              });\n            } else {\n              this.showErrorAlert(data.error.message);\n            }\n          }).catch(err => {\n            this.showErrorAlert('Ошибка запроса. Пожалуйста, попробуйте позже', () => {\n              this.changeData('activeStory', 'disconnect');\n            });\n          });\n        } else {\n          this.showErrorAlert(data.error.message);\n        }\n      }).catch(err => {\n        this.showErrorAlert('Ошибка запроса. Пожалуйста, попробуйте позже', () => {\n          this.changeData('activeStory', 'disconnect');\n        });\n      });\n    } else {\n      this.setState({\n        popout: /*#__PURE__*/React.createElement(Alert, {\n          actions: [{\n            title: 'Отмена',\n            autoclose: true,\n            style: 'cancel'\n          }],\n          onClose: this.closePopout,\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 82,\n            columnNumber: 21\n          }\n        }, /*#__PURE__*/React.createElement(\"h2\", {\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 90,\n            columnNumber: 21\n          }\n        }, \"\\u041E\\u0448\\u0438\\u0431\\u043A\\u0430\"), /*#__PURE__*/React.createElement(\"p\", {\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 91,\n            columnNumber: 21\n          }\n        }, \"\\u0417\\u0430\\u0433\\u043E\\u043B\\u043E\\u0432\\u043E\\u043A \\u0438\\u043B\\u0438 \\u0442\\u0435\\u043A\\u0441\\u0442 \\u043F\\u0440\\u043E\\u0431\\u043B\\u0435\\u043C\\u044B \\u0434\\u043E\\u043B\\u0436\\u0435\\u043D \\u0431\\u044B\\u0442\\u044C \\u0431\\u043E\\u043B\\u044C\\u0448\\u0435 5 \\u0441\\u0438\\u043C\\u0432\\u043E\\u043B\\u043E\\u0432.\"))\n      });\n    }\n  }\n\n  render() {\n    return /*#__PURE__*/React.createElement(Panel, {\n      id: this.props.id,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 99,\n        columnNumber: 17\n      }\n    }, /*#__PURE__*/React.createElement(PanelHeader, {\n      left: /*#__PURE__*/React.createElement(PanelHeaderButton, {\n        onClick: () => window.history.back(),\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 102,\n          columnNumber: 21\n        }\n      }, /*#__PURE__*/React.createElement(Icon24BrowserBack, {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 103,\n          columnNumber: 21\n        }\n      })),\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 100,\n        columnNumber: 17\n      }\n    }, \"\\u041D\\u043E\\u0432\\u044B\\u0439 \\u0432\\u043E\\u043F\\u0440\\u043E\\u0441\"), /*#__PURE__*/React.createElement(FormLayout, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 108,\n        columnNumber: 17\n      }\n    }, /*#__PURE__*/React.createElement(Input, {\n      top: this.state.title_new_tiket === null ? \"Суть проблемы (0/30). Не менее 5 символов\" : \"Суть проблемы (\" + this.state.title_new_tiket.length + \"/80). Не менее 5 символов\",\n      maxLength: \"80\",\n      type: \"text\",\n      name: \"title_new_tiket\",\n      placeholder: \"\\u0412\\u0432\\u0435\\u0434\\u0438\\u0442\\u0435 \\u0441\\u0432\\u043E\\u0439 \\u0442\\u0435\\u043A\\u0441\\u0442...\",\n      value: this.state.title_new_tiket,\n      onChange: e => this.onChange(e),\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 109,\n        columnNumber: 21\n      }\n    }), /*#__PURE__*/React.createElement(Textarea, {\n      maxLength: \"2020\",\n      name: \"text_new_tiket\",\n      top: this.state.text_new_tiket === null ? \"Подробнее о проблеме (0/2020). Не менее 5 символов\" : \"Подробнее о проблеме (\" + this.state.text_new_tiket.length + \"/2020). Не менее 5 символов\",\n      onChange: e => this.onChange(e),\n      placeholder: \"\\u0412\\u0432\\u0435\\u0434\\u0438\\u0442\\u0435 \\u0441\\u0432\\u043E\\u0439 \\u0442\\u0435\\u043A\\u0441\\u0442...\",\n      value: this.state.text_new_tiket,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 118,\n        columnNumber: 21\n      }\n    }), /*#__PURE__*/React.createElement(Button, {\n      size: \"xl\",\n      level: \"secondary\",\n      stretched: true,\n      disabled: !Boolean(this.state.text_new_tiket.length > 5) || !Boolean(this.state.title_new_tiket.length > 5),\n      onClick: () => {\n        this.sendNewTiket();\n      },\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 125,\n        columnNumber: 21\n      }\n    }, \"\\u041E\\u0442\\u043F\\u0440\\u0430\\u0432\\u0438\\u0442\\u044C\")));\n  }\n\n}","map":{"version":3,"sources":["C:/Users/rshub/Desktop/Road-to-Jedi/mobile-road/src/panels/questions/panels/new_tiket.js"],"names":["React","Panel","PanelHeader","PanelHeaderButton","Button","Alert","ScreenSpinner","Input","FormLayout","Textarea","Icon24BrowserBack","NewTicket","Component","constructor","props","state","api_url","title_new_tiket","text_new_tiket","sendNewTiket","bind","onChange","event","name","currentTarget","value","setState","getRandomInRange","min","max","Math","floor","random","popout","length","fetch","window","location","search","replace","method","headers","body","JSON","stringify","then","res","json","data","result","tiket_all","response","showErrorAlert","error","message","catch","err","changeData","title","autoclose","style","closePopout","render","id","history","back","e","Boolean"],"mappings":"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","sourcesContent":["import React from 'react';\n\nimport { \n    Panel,\n    PanelHeader,\n    PanelHeaderButton,\n    Button,\n    Alert,\n    ScreenSpinner,\n    Input,\n    FormLayout,\n    Textarea,\n    } from '@vkontakte/vkui';\n\n\nimport Icon24BrowserBack from '@vkontakte/icons/dist/24/browser_back';\n\nexport default class NewTicket extends React.Component {\n        constructor(props) {\n            super(props);\n            this.state = {\n                api_url: \"https://xelene.ru/road/php/index.php?\",\n                title_new_tiket: '',\n                text_new_tiket: '',\n            }\n            this.sendNewTiket = this.sendNewTiket.bind(this);\n            this.onChange = (event) => {\n                var name = event.currentTarget.name;\n                var value = event.currentTarget.value;\n                this.setState({ [name]: value });\n            }\n        }\n        getRandomInRange(min, max) {\n            return Math.floor(Math.random() * (max - min + 1)) + min;\n          }\n        sendNewTiket() {\n            this.setState({popout: <ScreenSpinner/>})\n            if(this.state.text_new_tiket.length > 5 || this.state.title_new_tiket.length > 5) {\n                fetch(this.state.api_url + \"method=ticket.add&\" + window.location.search.replace('?', ''), \n                {method: 'post',\n                headers: {\"Content-type\": \"application/json; charset=UTF-8\"},\n                    // signal: controllertime.signal,\n                body: JSON.stringify({\n                    'title': this.state.title_new_tiket,\n                    'text': this.state.text_new_tiket,\n                    'user': this.getRandomInRange(501, 624429367),\n                })\n                })\n                .then(res => res.json())\n                .then(data => {\n                    if(data.result) {\n                        fetch(this.state.api_url + \"method=tickets.get&\" + window.location.search.replace('?', ''),\n                        {method: 'post',\n                        headers: {\"Content-type\": \"application/json; charset=UTF-8\"},\n                            // signal: controllertime.signal,\n                        body: JSON.stringify({\n                            'unanswered': 1,\n                        })\n                        })\n                        .then(res => res.json())\n                        .then(data => {\n                            if(data.result) {\n                                this.setState({tiket_all: data.response, popout: null, title_new_tiket: \"\", text_new_tiket: \"\"})\n                            }else{\n                                this.showErrorAlert(data.error.message)\n                            }\n                        })\n                        .catch(err => {\n                            this.showErrorAlert('Ошибка запроса. Пожалуйста, попробуйте позже',() => {this.changeData('activeStory', 'disconnect')})\n        \n                        })\n                    }else{\n                    this.showErrorAlert(data.error.message)\n                }\n                })\n                .catch(err => {\n                    this.showErrorAlert('Ошибка запроса. Пожалуйста, попробуйте позже',() => {this.changeData('activeStory', 'disconnect')})\n                })\n            }else{\n                this.setState({\n                    popout: \n                    <Alert\n                    actions={[{\n                    title: 'Отмена',\n                    autoclose: true,\n                    style: 'cancel'\n                    }]}\n                    onClose={this.closePopout}\n                >\n                    <h2>Ошибка</h2>\n                    <p>Заголовок или текст проблемы должен быть больше 5 символов.</p>\n                </Alert>\n                    })\n            }\n        }\n\n        render() {\n            return (\n                <Panel id={this.props.id}>\n                <PanelHeader \n                    left={\n                    <PanelHeaderButton onClick={() => window.history.back()}> \n                    <Icon24BrowserBack/>\n                    </PanelHeaderButton>\n                    }>\n                Новый вопрос\n                </PanelHeader>\n                <FormLayout>\n                    <Input \n                    top={this.state.title_new_tiket === null ? \"Суть проблемы (0/30). Не менее 5 символов\" : \"Суть проблемы (\" + this.state.title_new_tiket.length + \"/80). Не менее 5 символов\"}\n                    maxLength=\"80\" \n                    type=\"text\" \n                    name=\"title_new_tiket\" \n                    placeholder='Введите свой текст...'\n                    value={this.state.title_new_tiket} \n                    onChange={(e) => this.onChange(e)}/>\n\n                    <Textarea maxLength=\"2020\" \n                    name=\"text_new_tiket\" \n                    top={this.state.text_new_tiket === null ? \"Подробнее о проблеме (0/2020). Не менее 5 символов\" : \"Подробнее о проблеме (\" + this.state.text_new_tiket.length + \"/2020). Не менее 5 символов\"} \n                    onChange={(e) => this.onChange(e)}\n                    placeholder='Введите свой текст...'\n                    value={this.state.text_new_tiket}\n                    ></Textarea>\n                    <Button\n                    size=\"xl\" \n                    level=\"secondary\" \n                    stretched \n                    disabled={!Boolean(this.state.text_new_tiket.length > 5) || !Boolean(this.state.title_new_tiket.length > 5)}\n                    onClick={\n                        () => {\n                            this.sendNewTiket();\n                        }\n                    }>Отправить</Button>\n                </FormLayout>\n            </Panel>\n            )\n            }\n        }\n  "]},"metadata":{},"sourceType":"module"}