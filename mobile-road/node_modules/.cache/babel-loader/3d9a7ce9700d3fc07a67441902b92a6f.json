{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\rshub\\\\Desktop\\\\Road-to-Jedi\\\\mobile-road\\\\src\\\\panels\\\\topUsers\\\\main.js\";\nimport React from 'react'; // React\n\nimport bridge from '@vkontakte/vk-bridge'; // VK Brige\n\nimport { Alert, Avatar, View, ScreenSpinner, ModalRoot, ModalCard, Input } from '@vkontakte/vkui';\nimport '@vkontakte/vkui/dist/vkui.css';\nimport '../../style.css'; // –ò–º–ø–æ—Ä—Ç–∏—Ä—É–µ–º –ø–∞–Ω–µ–ª–∏\n\nimport Top from './panels/top';\nimport OtherProfile from '../../components/other_profile'; //–ò–º–ø–æ—Ä—Ç–∏—Ä—É–µ–º –º–æ–¥–∞–ª—å–Ω—ã–µ –∫–∞—Ä—Ç–æ—á–∫–∏\n\nimport ModalPrometay from '../../Modals/Prometay';\nimport ModalDonut from '../../Modals/Donut'; // const platformname = (/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent));\n// const queryString = require('query-string');\n// const parsedHash = queryString.parse(window.location.search.replace('?', ''));\n// const hash = queryString.parse(window.location.hash);\n\nexport default class Main extends React.Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      api_url: \"https://xelene.ru/road/php/index.php?\",\n      activePanel: 'top',\n      activeModal: null,\n      modalHistory: [],\n      popout: this.props.popout,\n      ticket_id: null,\n      history: ['top'],\n      active_other_profile: 0,\n      other_profile: null,\n      ban_reason: \"\",\n      comment: '',\n      transfer: {\n        'avatar': '',\n        'comment': ''\n      },\n      AgeUser: 0,\n      top_agents: null\n    };\n    this.changeData = this.props.this.changeData;\n    this.playAudio = this.props.this.playAudio; // this.copy = this.props.this.copy;\n    // this.recordHistory = (panel) => {\n    //   this.setState({history: [...this.state.history, panel]})\n    // }\n\n    this.getTopUsers = () => {\n      fetch(this.state.api_url + \"method=users.getTop&\" + window.location.search.replace('?', '')).then(res => res.json()).then(data => {\n        if (data.result) {\n          this.setState({\n            top_agents: data.response\n          });\n          this.setPopout(null);\n        } else {\n          this.showErrorAlert(data.error.message);\n        }\n      }).catch(err => {\n        this.showErrorAlert('–û—à–∏–±–∫–∞ –∑–∞–ø—Ä–æ—Å–∞. –ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –ø–æ–ø—Ä–æ–±—É–π—Ç–µ –ø–æ–∑–∂–µ', () => {\n          this.changeData('activeStory', 'disconnect');\n        });\n      });\n    };\n\n    this.setPopout = value => {\n      this.setState({\n        popout: value\n      });\n    };\n\n    this.handlePopstate = e => {\n      e.preventDefault();\n      this.goBack();\n    };\n\n    this.goTiket = id => {\n      this.setPopout( /*#__PURE__*/React.createElement(ScreenSpinner, {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 88,\n          columnNumber: 26\n        }\n      }));\n      this.setState({\n        ticket_id: id\n      });\n      this.goPanel('ticket');\n      this.setPopout(null);\n    };\n\n    this.onChange = event => {\n      var name = event.currentTarget.name;\n      var value = event.currentTarget.value;\n      this.setState({\n        [name]: value\n      });\n    };\n\n    this.goOtherProfile = id => {\n      this.setState({\n        active_other_profile: id\n      });\n      this.goPanel(\"other_profile\");\n    };\n\n    this.modalBack = () => {\n      this.setActiveModal(this.state.modalHistory[this.state.modalHistory.length - 2]);\n    };\n\n    this.goBack = () => {\n      const history = this.state.history;\n      this.setActiveModal(null);\n\n      if (history.length === 1) {\n        bridge.send(\"VKWebAppClose\", {\n          \"status\": \"success\"\n        });\n      } else if (history.length > 1) {\n        history.pop();\n\n        if (this.state.activePanel === 'questions') {\n          bridge.send('VKWebAppDisableSwipeBack');\n        }\n\n        this.setState({\n          activePanel: history[history.length - 1]\n        }); // if(history[history.length - 1] === 'ticket'){\n        //   this.changeData('need_epic', false)\n        // } else{\n        //   this.changeData('need_epic', true)\n        // }\n      }\n    };\n\n    this.goPanel = panel => {\n      let history = this.state.history.slice();\n      history.push(panel);\n      window.history.pushState({\n        panel: panel\n      }, panel);\n\n      if (panel === 'top') {\n        bridge.send('VKWebAppEnableSwipeBack');\n      }\n\n      this.setState({\n        history: history,\n        activePanel: panel\n      }); // if(panel === 'ticket'){\n      //   this.changeData('need_epic', false)\n      // } else{\n      //   this.changeData('need_epic', true)\n      // }\n    };\n\n    this.setActiveModal = activeModal => {\n      activeModal = activeModal || null;\n      let modalHistory = this.state.modalHistory ? [...this.state.modalHistory] : [];\n\n      if (activeModal === null) {\n        modalHistory = [];\n      } else if (modalHistory.indexOf(activeModal) !== -1) {\n        modalHistory = modalHistory.splice(0, modalHistory.indexOf(activeModal) + 1);\n      } else {\n        modalHistory.push(activeModal);\n      }\n\n      this.setState({\n        activeModal: activeModal,\n        modalHistory: modalHistory\n      });\n    };\n\n    this.showAlert = (title, text) => {\n      this.setState({\n        popout: /*#__PURE__*/React.createElement(Alert, {\n          actions: [{\n            title: '–ó–∞–∫—Ä—ã—Ç—å',\n            autoclose: true,\n            mode: 'cancel'\n          }],\n          onClose: () => this.setPopout(null),\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 157,\n            columnNumber: 17\n          }\n        }, /*#__PURE__*/React.createElement(\"h2\", {\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 165,\n            columnNumber: 19\n          }\n        }, title), /*#__PURE__*/React.createElement(\"p\", {\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 166,\n            columnNumber: 19\n          }\n        }, text))\n      });\n    };\n\n    this.showErrorAlert = (error = null, action = null) => {\n      this.setPopout( /*#__PURE__*/React.createElement(Alert, {\n        actions: [{\n          title: '–û—Ç–º–µ–Ω–∞',\n          autoclose: true,\n          mode: 'cancel',\n          action: action\n        }],\n        onClose: () => this.setPopout(null),\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 172,\n          columnNumber: 15\n        }\n      }, /*#__PURE__*/React.createElement(\"h2\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 181,\n          columnNumber: 17\n        }\n      }, \"\\u041E\\u0448\\u0438\\u0431\\u043A\\u0430\"), error ? /*#__PURE__*/React.createElement(\"p\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 182,\n          columnNumber: 26\n        }\n      }, error) : /*#__PURE__*/React.createElement(\"p\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 182,\n          columnNumber: 43\n        }\n      }, \"\\u0427\\u0442\\u043E-\\u0442\\u043E \\u043F\\u043E\\u0448\\u043B\\u043E \\u043D\\u0435 \\u0442\\u0430\\u043A, \\u043F\\u043E\\u043F\\u0440\\u043E\\u0431\\u0443\\u0439\\u0442\\u0435 \\u0441\\u043D\\u043E\\u0432\\u0430!\")));\n    };\n  }\n\n  userBan(user_id, text) {\n    this.setPopout( /*#__PURE__*/React.createElement(ScreenSpinner, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 189,\n        columnNumber: 22\n      }\n    }));\n    fetch(this.state.api_url + \"method=account.ban&\" + window.location.search.replace('?', ''), {\n      method: 'post',\n      headers: {\n        \"Content-type\": \"application/json; charset=UTF-8\"\n      },\n      // signal: controllertime.signal,\n      body: JSON.stringify({\n        'agent_id': user_id,\n        'banned': true,\n        'reason': text\n      })\n    }).then(res => res.json()).then(data => {\n      if (data.result) {\n        this.setActiveModal(null);\n        this.showAlert('–£—Å–ø–µ—Ö', '–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –∑–∞–±–∞–Ω–µ–Ω');\n        this.setPopout(null);\n      } else {\n        this.showErrorAlert(data.error.message);\n      }\n    }).catch(err => {\n      this.showErrorAlert('–û—à–∏–±–∫–∞ –∑–∞–ø—Ä–æ—Å–∞. –ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –ø–æ–ø—Ä–æ–±—É–π—Ç–µ –ø–æ–∑–∂–µ', () => {\n        this.changeData('activeStory', 'disconnect');\n      });\n    });\n  }\n\n  getRandomTiket() {\n    fetch(this.state.api_url + \"method=ticket.getRandom&\" + window.location.search.replace('?', '')).then(res => res.json()).then(data => {\n      if (data.result) {\n        this.goTiket(data.response.id);\n      } else {\n        this.showErrorAlert(data.error.message);\n      }\n    }).catch(err => {\n      this.showErrorAlert('–û—à–∏–±–∫–∞ –∑–∞–ø—Ä–æ—Å–∞. –ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –ø–æ–ø—Ä–æ–±—É–π—Ç–µ –ø–æ–∑–∂–µ', () => {\n        this.changeData('activeStory', 'disconnect');\n      });\n    });\n  }\n\n  componentDidMount() {\n    bridge.send('VKWebAppEnableSwipeBack');\n    window.addEventListener('popstate', this.handlePopstate);\n    this.getTopUsers();\n  }\n\n  componentWillUnmount() {\n    bridge.send('VKWebAppDisableSwipeBack');\n    window.removeEventListener('popstate', this.handlePopstate);\n  }\n\n  render() {\n    const modal = /*#__PURE__*/React.createElement(ModalRoot, {\n      activeModal: this.state.activeModal,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 242,\n        columnNumber: 13\n      }\n    }, /*#__PURE__*/React.createElement(ModalPrometay, {\n      id: \"prom\",\n      onClose: () => this.setActiveModal(null),\n      action: () => this.setActiveModal(null),\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 245,\n        columnNumber: 15\n      }\n    }), /*#__PURE__*/React.createElement(ModalDonut, {\n      id: \"donut\",\n      onClose: () => this.setActiveModal(null),\n      action: () => this.setActiveModal(null),\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 250,\n        columnNumber: 15\n      }\n    }), /*#__PURE__*/React.createElement(ModalCard, {\n      id: \"ban_user\",\n      onClose: () => this.setActiveModal(null),\n      icon: /*#__PURE__*/React.createElement(Avatar, {\n        src: this.state.other_profile ? this.state.other_profile['avatar']['url'] : null,\n        size: 72,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 258,\n          columnNumber: 23\n        }\n      }),\n      header: \"\\u0417\\u0430\\u0431\\u0430\\u043D\\u0438\\u0442\\u044C \\u043F\\u043E\\u043B\\u044C\\u0437\\u043E\\u0432\\u0430\\u0442\\u0435\\u043B\\u044F\",\n      actions: [{\n        title: '–ó–∞–±–∞–Ω–∏—Ç—å! ü§¨',\n        mode: 'secondary',\n        action: () => {\n          this.userBan(this.state.other_profile ? this.state.other_profile['id'] : 0, this.state.ban_reason);\n          console.log(this.state.other_profile['id']);\n        }\n      }],\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 255,\n        columnNumber: 15\n      }\n    }, /*#__PURE__*/React.createElement(Input, {\n      disabled: true,\n      value: this.state.other_profile ? this.state.other_profile['id'] < 0 ? -this.state.other_profile['id'] : this.state.other_profile['id'] : null,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 269,\n        columnNumber: 17\n      }\n    }), /*#__PURE__*/React.createElement(\"br\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 270,\n        columnNumber: 17\n      }\n    }), /*#__PURE__*/React.createElement(Input, {\n      maxLength: \"100\",\n      name: \"ban_reason\",\n      onChange: e => this.onChange(e),\n      placeholder: \"\\u0412\\u0432\\u0435\\u0434\\u0438\\u0442\\u0435 \\u043F\\u0440\\u0438\\u0447\\u0438\\u043D\\u0443 \\u0431\\u0430\\u043D\\u0430\",\n      value: this.state.ban_reason,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 271,\n        columnNumber: 17\n      }\n    })), /*#__PURE__*/React.createElement(ModalCard, {\n      id: \"transfer\",\n      onClose: () => this.setActiveModal(null),\n      icon: /*#__PURE__*/React.createElement(Avatar, {\n        src: this.state.transfer.avatar,\n        size: 72,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 278,\n          columnNumber: 23\n        }\n      }),\n      header: \"\\u041F\\u0435\\u0440\\u0435\\u0432\\u043E\\u0434 \\u043C\\u043E\\u043D\\u0435\\u0442\\u043E\\u043A\",\n      caption: this.state.transfer.comment,\n      actions: [{\n        title: '–ó–∞–∫—Ä—ã—Ç—å',\n        mode: 'secondary',\n        action: () => {\n          this.setActiveModal(null);\n        }\n      }],\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 275,\n        columnNumber: 15\n      }\n    }));\n    return /*#__PURE__*/React.createElement(View, {\n      id: this.props.id,\n      activePanel: this.state.activePanel,\n      modal: modal,\n      popout: this.state.popout,\n      history: this.state.history,\n      onSwipeBack: () => window.history.back(),\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 293,\n        columnNumber: 13\n      }\n    }, /*#__PURE__*/React.createElement(Top, {\n      id: \"top\",\n      this: this,\n      account: this.props.account,\n      top_agents: this.state.top_agents,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 301,\n        columnNumber: 15\n      }\n    }), /*#__PURE__*/React.createElement(OtherProfile, {\n      id: \"other_profile\",\n      this: this,\n      agent_id: this.state.active_other_profile,\n      account: this.props.account,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 302,\n        columnNumber: 15\n      }\n    }));\n  }\n\n}","map":{"version":3,"sources":["C:/Users/rshub/Desktop/Road-to-Jedi/mobile-road/src/panels/topUsers/main.js"],"names":["React","bridge","Alert","Avatar","View","ScreenSpinner","ModalRoot","ModalCard","Input","Top","OtherProfile","ModalPrometay","ModalDonut","Main","Component","constructor","props","state","api_url","activePanel","activeModal","modalHistory","popout","ticket_id","history","active_other_profile","other_profile","ban_reason","comment","transfer","AgeUser","top_agents","changeData","this","playAudio","getTopUsers","fetch","window","location","search","replace","then","res","json","data","result","setState","response","setPopout","showErrorAlert","error","message","catch","err","value","handlePopstate","e","preventDefault","goBack","goTiket","id","goPanel","onChange","event","name","currentTarget","goOtherProfile","modalBack","setActiveModal","length","send","pop","panel","slice","push","pushState","indexOf","splice","showAlert","title","text","autoclose","mode","action","userBan","user_id","method","headers","body","JSON","stringify","getRandomTiket","componentDidMount","addEventListener","componentWillUnmount","removeEventListener","render","modal","console","log","avatar","back","account"],"mappings":"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","sourcesContent":["import React from 'react'; // React\r\nimport bridge from '@vkontakte/vk-bridge'; // VK Brige\r\n\r\n\r\nimport { \r\n  Alert,\r\n  Avatar,\r\n  View,\r\n  ScreenSpinner,\r\n  ModalRoot,\r\n  ModalCard,\r\n  Input,\r\n  } from '@vkontakte/vkui';\r\n\r\nimport '@vkontakte/vkui/dist/vkui.css';\r\nimport '../../style.css';\r\n// –ò–º–ø–æ—Ä—Ç–∏—Ä—É–µ–º –ø–∞–Ω–µ–ª–∏\r\nimport Top from './panels/top';\r\nimport OtherProfile from '../../components/other_profile';\r\n\r\n//–ò–º–ø–æ—Ä—Ç–∏—Ä—É–µ–º –º–æ–¥–∞–ª—å–Ω—ã–µ –∫–∞—Ä—Ç–æ—á–∫–∏\r\nimport ModalPrometay from '../../Modals/Prometay';\r\nimport ModalDonut from '../../Modals/Donut'\r\n\r\n\r\n// const platformname = (/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent));\r\n\r\n\r\n// const queryString = require('query-string');\r\n// const parsedHash = queryString.parse(window.location.search.replace('?', ''));\r\n// const hash = queryString.parse(window.location.hash);\r\n\r\nexport default class Main extends React.Component {\r\n    constructor(props) {\r\n        super(props);\r\n        this.state = {\r\n            api_url: \"https://xelene.ru/road/php/index.php?\",\r\n            activePanel: 'top',\r\n            activeModal: null,\r\n            modalHistory: [],\r\n            popout: this.props.popout,\r\n            ticket_id: null,\r\n            history: ['top'],\r\n            active_other_profile: 0,\r\n            other_profile: null,\r\n            ban_reason: \"\",\r\n            comment: '',\r\n            transfer: {\r\n              'avatar': '',\r\n              'comment': ''\r\n            },\r\n            AgeUser: 0,\r\n            top_agents: null,\r\n\r\n        \r\n\r\n        }\r\n        this.changeData = this.props.this.changeData;\r\n        this.playAudio = this.props.this.playAudio;\r\n        // this.copy = this.props.this.copy;\r\n        // this.recordHistory = (panel) => {\r\n        //   this.setState({history: [...this.state.history, panel]})\r\n        // }\r\n        this.getTopUsers = () => {\r\n          fetch(this.state.api_url + \"method=users.getTop&\" + window.location.search.replace('?', ''))\r\n          .then(res => res.json())\r\n          .then(data => {\r\n            if(data.result) {\r\n              this.setState({top_agents: data.response});\r\n              this.setPopout(null);\r\n            }else{\r\n              this.showErrorAlert(data.error.message)\r\n            }\r\n          })\r\n          .catch(err => {\r\n            this.showErrorAlert('–û—à–∏–±–∫–∞ –∑–∞–ø—Ä–æ—Å–∞. –ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –ø–æ–ø—Ä–æ–±—É–π—Ç–µ –ø–æ–∑–∂–µ',() => {this.changeData('activeStory', 'disconnect')})\r\n\r\n          })\r\n        }\r\n        this.setPopout = (value) => {\r\n          this.setState({popout: value})\r\n        }\r\n        this.handlePopstate = (e) => {\r\n          e.preventDefault();\r\n          this.goBack()\r\n        }\r\n        this.goTiket = (id) => {\r\n          this.setPopout(<ScreenSpinner/>)\r\n          this.setState({ticket_id: id})\r\n          this.goPanel('ticket');\r\n          this.setPopout(null);\r\n        }\r\n        this.onChange = (event) => {\r\n          var name = event.currentTarget.name;\r\n          var value = event.currentTarget.value;\r\n          this.setState({ [name]: value });\r\n      }\r\n        this.goOtherProfile = (id) => {\r\n          this.setState({active_other_profile: id})\r\n          this.goPanel(\"other_profile\")\r\n        }\r\n        this.modalBack = () => {\r\n            this.setActiveModal(this.state.modalHistory[this.state.modalHistory.length - 2]);\r\n        };\r\n        this.goBack = () => {\r\n          const history = this.state.history;\r\n          this.setActiveModal(null);\r\n          if(history.length === 1) {\r\n              bridge.send(\"VKWebAppClose\", {\"status\": \"success\"});\r\n          } else if (history.length > 1) {\r\n              history.pop()\r\n              if(this.state.activePanel === 'questions') {\r\n                bridge.send('VKWebAppDisableSwipeBack');\r\n              }\r\n              this.setState({activePanel: history[history.length - 1]})\r\n              // if(history[history.length - 1] === 'ticket'){\r\n              //   this.changeData('need_epic', false)\r\n              // } else{\r\n              //   this.changeData('need_epic', true)\r\n              // }\r\n          }\r\n      }\r\n        this.goPanel = (panel) => {\r\n          let history = this.state.history.slice();\r\n          history.push(panel)\r\n          window.history.pushState( { panel: panel }, panel );\r\n          if(panel === 'top') {\r\n            bridge.send('VKWebAppEnableSwipeBack');\r\n          }\r\n          this.setState({history: history, activePanel: panel})\r\n          // if(panel === 'ticket'){\r\n          //   this.changeData('need_epic', false)\r\n          // } else{\r\n          //   this.changeData('need_epic', true)\r\n          // }\r\n        }\r\n        this.setActiveModal = (activeModal) => {\r\n            activeModal = activeModal || null;\r\n            let modalHistory = this.state.modalHistory ? [...this.state.modalHistory] : [];\r\n        \r\n            if (activeModal === null) {\r\n              modalHistory = [];\r\n            } else if (modalHistory.indexOf(activeModal) !== -1) {\r\n              modalHistory = modalHistory.splice(0, modalHistory.indexOf(activeModal) + 1);\r\n            } else {\r\n              modalHistory.push(activeModal);\r\n            }\r\n        \r\n            this.setState({\r\n              activeModal: activeModal,\r\n              modalHistory: modalHistory\r\n            });\r\n          };\r\n          this.showAlert = (title, text) => {\r\n            this.setState({\r\n              popout: \r\n                <Alert\r\n                  actions={[{\r\n                    title: '–ó–∞–∫—Ä—ã—Ç—å',\r\n                    autoclose: true,\r\n                    mode: 'cancel'\r\n                  }]}\r\n                  onClose={() => this.setPopout(null)}\r\n                >\r\n                  <h2>{title}</h2>\r\n                  <p>{text}</p>\r\n              </Alert>\r\n            })\r\n          }\r\n          this.showErrorAlert = (error=null, action=null) => {\r\n            this.setPopout(\r\n              <Alert\r\n                  actions={[{\r\n                  title: '–û—Ç–º–µ–Ω–∞',\r\n                  autoclose: true,\r\n                  mode: 'cancel',\r\n                  action: action,\r\n                  }]}\r\n                  onClose={() => this.setPopout(null)}\r\n              >\r\n                <h2>–û—à–∏–±–∫–∞</h2>\r\n                {error ? <p>{error}</p> : <p>–ß—Ç–æ-—Ç–æ –ø–æ—à–ª–æ –Ω–µ —Ç–∞–∫, –ø–æ–ø—Ä–æ–±—É–π—Ç–µ —Å–Ω–æ–≤–∞!</p>}\r\n              </Alert>\r\n          )\r\n        }\r\n    }\r\n\r\n    userBan(user_id, text) {\r\n      this.setPopout(<ScreenSpinner/>)\r\n      fetch(this.state.api_url + \"method=account.ban&\" + window.location.search.replace('?', ''),\r\n      {method: 'post',\r\n      headers: {\"Content-type\": \"application/json; charset=UTF-8\"},\r\n          // signal: controllertime.signal,\r\n      body: JSON.stringify({\r\n        'agent_id': user_id,\r\n        'banned': true,\r\n        'reason': text,\r\n\r\n    })\r\n      })\r\n      .then(res => res.json())\r\n      .then(data => {\r\n        if(data.result) {\r\n          this.setActiveModal(null);\r\n          this.showAlert('–£—Å–ø–µ—Ö', '–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –∑–∞–±–∞–Ω–µ–Ω');\r\n          this.setPopout(null);\r\n        }else {\r\n          this.showErrorAlert(data.error.message)\r\n        }\r\n      })\r\n      .catch(err => {\r\n        this.showErrorAlert('–û—à–∏–±–∫–∞ –∑–∞–ø—Ä–æ—Å–∞. –ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –ø–æ–ø—Ä–æ–±—É–π—Ç–µ –ø–æ–∑–∂–µ',() => {this.changeData('activeStory', 'disconnect')})\r\n      })\r\n    }\r\n    getRandomTiket() {\r\n      fetch(this.state.api_url + \"method=ticket.getRandom&\" + window.location.search.replace('?', ''))\r\n        .then(res => res.json())\r\n        .then(data => {\r\n          if(data.result) {\r\n            this.goTiket(data.response.id)\r\n          } else {\r\n            this.showErrorAlert(data.error.message)\r\n          }\r\n        })\r\n        .catch(err => {\r\n          this.showErrorAlert('–û—à–∏–±–∫–∞ –∑–∞–ø—Ä–æ—Å–∞. –ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –ø–æ–ø—Ä–æ–±—É–π—Ç–µ –ø–æ–∑–∂–µ',() => {this.changeData('activeStory', 'disconnect')})\r\n\r\n        })\r\n    }\r\n    \r\n    componentDidMount(){\r\n      bridge.send('VKWebAppEnableSwipeBack');\r\n      window.addEventListener('popstate', this.handlePopstate); \r\n      this.getTopUsers()\r\n    }\r\n    componentWillUnmount(){\r\n      bridge.send('VKWebAppDisableSwipeBack');\r\n      window.removeEventListener('popstate', this.handlePopstate)\r\n    }\r\n    render() {\r\n        const modal = (\r\n            <ModalRoot\r\n            activeModal={this.state.activeModal}\r\n            >\r\n              <ModalPrometay\r\n              id='prom'\r\n              onClose={() => this.setActiveModal(null)}\r\n              action={() => this.setActiveModal(null)} />\r\n\r\n              <ModalDonut\r\n              id='donut'\r\n              onClose={() => this.setActiveModal(null)}\r\n              action={() => this.setActiveModal(null)} />\r\n\r\n              <ModalCard\r\n                id='ban_user'\r\n                onClose={() => this.setActiveModal(null)}\r\n                icon={<Avatar src={this.state.other_profile ? this.state.other_profile['avatar']['url'] : null} size={72} />}\r\n                header=\"–ó–∞–±–∞–Ω–∏—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è\"\r\n                actions={[{\r\n                  title: '–ó–∞–±–∞–Ω–∏—Ç—å! ü§¨',\r\n                  mode: 'secondary',\r\n                  action: () => {\r\n                    this.userBan(this.state.other_profile ? this.state.other_profile['id'] : 0, this.state.ban_reason);\r\n                    console.log(this.state.other_profile['id'])\r\n                  }\r\n                }]}\r\n              >\r\n                <Input disabled value={this.state.other_profile ? (this.state.other_profile['id'] < 0) ? -this.state.other_profile['id'] : this.state.other_profile['id'] : null}/>\r\n                <br/>\r\n                <Input maxLength=\"100\" name=\"ban_reason\" onChange={(e) => this.onChange(e)} placeholder=\"–í–≤–µ–¥–∏—Ç–µ –ø—Ä–∏—á–∏–Ω—É –±–∞–Ω–∞\" value={this.state.ban_reason} />\r\n                \r\n              </ModalCard>\r\n              \r\n              <ModalCard\r\n                id='transfer'\r\n                onClose={() => this.setActiveModal(null)}\r\n                icon={<Avatar src={this.state.transfer.avatar} size={72} />}\r\n                header='–ü–µ—Ä–µ–≤–æ–¥ –º–æ–Ω–µ—Ç–æ–∫'\r\n                caption={this.state.transfer.comment}\r\n                actions={[{\r\n                  title: '–ó–∞–∫—Ä—ã—Ç—å',\r\n                  mode: 'secondary',\r\n                  action: () => {\r\n                    this.setActiveModal(null);\r\n                  }\r\n                }]}\r\n              >\r\n              </ModalCard>\r\n            </ModalRoot>\r\n        )\r\n        return(\r\n            <View \r\n            id={this.props.id}\r\n            activePanel={this.state.activePanel}\r\n            modal={modal}\r\n            popout={this.state.popout}\r\n            history={this.state.history}\r\n            onSwipeBack={() => window.history.back()}\r\n            >\r\n              <Top id=\"top\" this={this} account={this.props.account} top_agents={this.state.top_agents} />\r\n              <OtherProfile id=\"other_profile\" this={this} agent_id={this.state.active_other_profile} account={this.props.account}/>\r\n            </View>   \r\n        )\r\n    }\r\n}"]},"metadata":{},"sourceType":"module"}