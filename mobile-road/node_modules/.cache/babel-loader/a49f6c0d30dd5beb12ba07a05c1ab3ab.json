{"ast":null,"code":"import _defineProperty from\"C:\\\\Users\\\\rshub\\\\Desktop\\\\Road-to-Jedi\\\\mobile-road\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/defineProperty\";import _classCallCheck from\"C:\\\\Users\\\\rshub\\\\Desktop\\\\Road-to-Jedi\\\\mobile-road\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/classCallCheck\";import _createClass from\"C:\\\\Users\\\\rshub\\\\Desktop\\\\Road-to-Jedi\\\\mobile-road\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/createClass\";import _inherits from\"C:\\\\Users\\\\rshub\\\\Desktop\\\\Road-to-Jedi\\\\mobile-road\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/inherits\";import _createSuper from\"C:\\\\Users\\\\rshub\\\\Desktop\\\\Road-to-Jedi\\\\mobile-road\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/createSuper\";import React from'react';// React\nimport bridge from'@vkontakte/vk-bridge';// VK Brige\nimport{Alert,View,ScreenSpinner}from'@vkontakte/vkui';import'@vkontakte/vkui/dist/vkui.css';import'../../style.css';// Импортируем панели\nimport Startov from'./panels/start';import Startov2 from'./panels/start2';var ignore_back=false;var Start=/*#__PURE__*/function(_React$Component){_inherits(Start,_React$Component);var _super=_createSuper(Start);function Start(props){var _this;_classCallCheck(this,Start);_this=_super.call(this,props);_this.state={api_url:\"https://xelene.ru/road/php/index.php?\",activePanel:'start',popout:_this.props.popout,history:['start']};_this.changeData=_this.props.this.changeData;_this.ReloadProfile=_this.props.reloadProfile;// this.copy = this.props.this.copy;\n// this.recordHistory = (panel) => {\n//   this.setState({history: [...this.state.history, panel]})\n// }\n_this.setPopout=function(value){_this.setState({popout:value});};_this.handlePopstate=function(e){e.preventDefault();_this.goBack();};_this.onChange=function(event){var name=event.currentTarget.name;var value=event.currentTarget.value;_this.setState(_defineProperty({},name,value));};_this.modalBack=function(){_this.setActiveModal(_this.state.modalHistory[_this.state.modalHistory.length-2]);};_this.goBack=function(){if(!ignore_back){ignore_back=true;var history=_this.state.history;if(history.length===1){bridge.send(\"VKWebAppClose\",{\"status\":\"success\"});}else if(history.length>1){history.pop();if(_this.state.activePanel==='start'){bridge.send('VKWebAppDisableSwipeBack');}_this.setState({activePanel:history[history.length-1]});// if(history[history.length - 1] === 'ticket'){\n//   this.changeData('need_epic', false)\n// } else{\n//   this.changeData('need_epic', true)\n// }\n_this.setPopout(/*#__PURE__*/React.createElement(ScreenSpinner,null));setTimeout(function(){_this.setPopout(null);},500);}setTimeout(function(){ignore_back=false;},500);}else{var _history=_this.state.history;window.history.pushState({panel:_history[_history.length-1]},_history[_history.length-1]);}};_this.goPanel=function(panel){var history=_this.state.history.slice();history.push(panel);window.history.pushState({panel:panel},panel);if(panel==='start'){bridge.send('VKWebAppEnableSwipeBack');}_this.setState({history:history,activePanel:panel});// if(panel === 'ticket'){\n//   this.changeData('need_epic', false)\n// } else{\n//   this.changeData('need_epic', true)\n// }\n};_this.showAlert=function(title,text){_this.setState({popout:/*#__PURE__*/React.createElement(Alert,{actions:[{title:'Закрыть',autoclose:true,mode:'cancel'}],onClose:function onClose(){return _this.setPopout(null);}},/*#__PURE__*/React.createElement(\"h2\",null,title),/*#__PURE__*/React.createElement(\"p\",null,text))});};_this.showErrorAlert=function(){var error=arguments.length>0&&arguments[0]!==undefined?arguments[0]:null;var action=arguments.length>1&&arguments[1]!==undefined?arguments[1]:null;_this.setPopout(/*#__PURE__*/React.createElement(Alert,{actions:[{title:'Отмена',autoclose:true,mode:'cancel',action:action}],onClose:function onClose(){return _this.setPopout(null);}},/*#__PURE__*/React.createElement(\"h2\",null,\"\\u041E\\u0448\\u0438\\u0431\\u043A\\u0430\"),error?/*#__PURE__*/React.createElement(\"p\",null,error):/*#__PURE__*/React.createElement(\"p\",null,\"\\u0427\\u0442\\u043E-\\u0442\\u043E \\u043F\\u043E\\u0448\\u043B\\u043E \\u043D\\u0435 \\u0442\\u0430\\u043A, \\u043F\\u043E\\u043F\\u0440\\u043E\\u0431\\u0443\\u0439\\u0442\\u0435 \\u0441\\u043D\\u043E\\u0432\\u0430!\")));};return _this;}_createClass(Start,[{key:\"componentDidMount\",value:function componentDidMount(){bridge.send('VKWebAppEnableSwipeBack');window.addEventListener('popstate',this.handlePopstate);this.changeData('need_epic',false);}},{key:\"componentWillUnmount\",value:function componentWillUnmount(){bridge.send('VKWebAppDisableSwipeBack');window.removeEventListener('popstate',this.handlePopstate);}},{key:\"render\",value:function render(){return/*#__PURE__*/React.createElement(View,{id:this.props.id,activePanel:this.state.activePanel,popout:this.state.popout,history:this.state.history,onSwipeBack:function onSwipeBack(){return window.history.back();}},/*#__PURE__*/React.createElement(Startov,{id:\"start\",account:this.props.account,this:this}),/*#__PURE__*/React.createElement(Startov2,{id:\"start2\",account:this.props.account,this:this}));}}]);return Start;}(React.Component);export{Start as default};","map":{"version":3,"sources":["C:/Users/rshub/Desktop/Road-to-Jedi/mobile-road/src/panels/Start/main.js"],"names":["React","bridge","Alert","View","ScreenSpinner","Startov","Startov2","ignore_back","Start","props","state","api_url","activePanel","popout","history","changeData","this","ReloadProfile","reloadProfile","setPopout","value","setState","handlePopstate","e","preventDefault","goBack","onChange","event","name","currentTarget","modalBack","setActiveModal","modalHistory","length","send","pop","setTimeout","window","pushState","panel","goPanel","slice","push","showAlert","title","text","autoclose","mode","showErrorAlert","error","action","addEventListener","removeEventListener","id","back","account","Component"],"mappings":"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","sourcesContent":["import React from 'react'; // React\r\nimport bridge from '@vkontakte/vk-bridge'; // VK Brige\r\n\r\nimport { \r\n  Alert,\r\n  View,\r\n  ScreenSpinner,\r\n  } from '@vkontakte/vkui';\r\n\r\nimport '@vkontakte/vkui/dist/vkui.css';\r\nimport '../../style.css'\r\n// Импортируем панели\r\nimport Startov from './panels/start';\r\nimport Startov2 from './panels/start2';\r\n\r\nvar ignore_back = false;\r\n\r\nexport default class Start extends React.Component {\r\n    constructor(props) {\r\n        super(props);\r\n        this.state = {\r\n            api_url: \"https://xelene.ru/road/php/index.php?\",\r\n            activePanel: 'start',\r\n            popout: this.props.popout,\r\n            history: ['start'],\r\n        \r\n\r\n        }\r\n        this.changeData = this.props.this.changeData;\r\n        this.ReloadProfile = this.props.reloadProfile;\r\n        // this.copy = this.props.this.copy;\r\n        // this.recordHistory = (panel) => {\r\n        //   this.setState({history: [...this.state.history, panel]})\r\n        // }\r\n        this.setPopout = (value) => {\r\n          this.setState({popout: value})\r\n        }\r\n        this.handlePopstate = (e) => {\r\n          e.preventDefault();\r\n          this.goBack()\r\n        }\r\n        this.onChange = (event) => {\r\n          var name = event.currentTarget.name;\r\n          var value = event.currentTarget.value;\r\n          this.setState({ [name]: value });\r\n      }\r\n        this.modalBack = () => {\r\n            this.setActiveModal(this.state.modalHistory[this.state.modalHistory.length - 2]);\r\n        };\r\n        this.goBack = () => {\r\n          if(!ignore_back){\r\n            ignore_back = true;\r\n            const history = this.state.history;\r\n            if(history.length === 1) {\r\n                bridge.send(\"VKWebAppClose\", {\"status\": \"success\"});\r\n            } else if (history.length > 1) {\r\n                history.pop()\r\n                if (this.state.activePanel === 'start') {\r\n                  bridge.send('VKWebAppDisableSwipeBack');\r\n                }\r\n                this.setState({activePanel: history[history.length - 1]})\r\n                // if(history[history.length - 1] === 'ticket'){\r\n                //   this.changeData('need_epic', false)\r\n                // } else{\r\n                //   this.changeData('need_epic', true)\r\n                // }\r\n                this.setPopout(<ScreenSpinner />)\r\n                setTimeout(() => {\r\n                  this.setPopout(null)\r\n                }, 500)\r\n            }\r\n            setTimeout(() => {ignore_back = false;}, 500)\r\n            \r\n          }else{\r\n            const history = this.state.history;\r\n            window.history.pushState( { panel: history[history.length - 1] }, history[history.length - 1] );\r\n          }\r\n      }\r\n        this.goPanel = (panel) => {\r\n          let history = this.state.history.slice();\r\n          history.push(panel)\r\n          window.history.pushState( { panel: panel }, panel );\r\n          if(panel === 'start') {\r\n            bridge.send('VKWebAppEnableSwipeBack');\r\n          }\r\n          this.setState({history: history, activePanel: panel})\r\n          // if(panel === 'ticket'){\r\n          //   this.changeData('need_epic', false)\r\n          // } else{\r\n          //   this.changeData('need_epic', true)\r\n          // }\r\n        }\r\n          this.showAlert = (title, text) => {\r\n            this.setState({\r\n              popout: \r\n                <Alert\r\n                  actions={[{\r\n                    title: 'Закрыть',\r\n                    autoclose: true,\r\n                    mode: 'cancel'\r\n                  }]}\r\n                  onClose={() => this.setPopout(null)}\r\n                >\r\n                  <h2>{title}</h2>\r\n                  <p>{text}</p>\r\n              </Alert>\r\n            })\r\n          }\r\n          this.showErrorAlert = (error=null, action=null) => {\r\n            this.setPopout(\r\n              <Alert\r\n                  actions={[{\r\n                  title: 'Отмена',\r\n                  autoclose: true,\r\n                  mode: 'cancel',\r\n                  action: action,\r\n                  }]}\r\n                  onClose={() => this.setPopout(null)}\r\n              >\r\n                <h2>Ошибка</h2>\r\n                {error ? <p>{error}</p> : <p>Что-то пошло не так, попробуйте снова!</p>}\r\n              </Alert>\r\n          )\r\n        }\r\n    }\r\n    componentDidMount(){\r\n      bridge.send('VKWebAppEnableSwipeBack');\r\n      window.addEventListener('popstate', this.handlePopstate); \r\n      this.changeData('need_epic', false)\r\n    }\r\n    componentWillUnmount(){\r\n      bridge.send('VKWebAppDisableSwipeBack');\r\n      window.removeEventListener('popstate', this.handlePopstate)\r\n    }\r\n    render() {\r\n        return(\r\n            <View \r\n            id={this.props.id}\r\n            activePanel={this.state.activePanel}\r\n            popout={this.state.popout}\r\n            history={this.state.history}\r\n            onSwipeBack={() => window.history.back()}\r\n            >\r\n              <Startov id='start' account={this.props.account} this={this} />\r\n              <Startov2 id='start2' account={this.props.account} this={this} />\r\n            </View>   \r\n        )\r\n    }\r\n}"]},"metadata":{},"sourceType":"module"}