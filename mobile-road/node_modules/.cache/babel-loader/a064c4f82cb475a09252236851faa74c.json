{"ast":null,"code":"import _defineProperty from\"C:\\\\Users\\\\rshub\\\\Desktop\\\\Road-to-Jedi\\\\mobile-road\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/defineProperty\";import _classCallCheck from\"C:\\\\Users\\\\rshub\\\\Desktop\\\\Road-to-Jedi\\\\mobile-road\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/classCallCheck\";import _createClass from\"C:\\\\Users\\\\rshub\\\\Desktop\\\\Road-to-Jedi\\\\mobile-road\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/createClass\";import _assertThisInitialized from\"C:\\\\Users\\\\rshub\\\\Desktop\\\\Road-to-Jedi\\\\mobile-road\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/assertThisInitialized\";import _inherits from\"C:\\\\Users\\\\rshub\\\\Desktop\\\\Road-to-Jedi\\\\mobile-road\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/inherits\";import _createSuper from\"C:\\\\Users\\\\rshub\\\\Desktop\\\\Road-to-Jedi\\\\mobile-road\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/createSuper\";import React from'react';import bridge from'@vkontakte/vk-bridge';// VK Brige\nimport{Panel,PanelHeader,Button,FixedLayout,Div,ScreenSpinner,ActionSheet,ActionSheetItem,PanelHeaderBack,Separator,WriteBarIcon,WriteBar,FormStatus,Snackbar,Avatar}from'@vkontakte/vkui';import Icon16ReplyOutline from'@vkontakte/icons/dist/16/reply_outline';import Icon16CheckCircle from'@vkontakte/icons/dist/16/check_circle';// import Ninja from '../images/Ninja.webp'\nimport Message from'./message';// const platformname = (/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent));\nvar queryString=require('query-string');var parsedHash=queryString.parse(window.location.search.replace('?',''));var months=['января','февраля','марта','апреля','мая','июня','июля','августа','сентября','ноября','декабря'];function fix_time(time){if(time<10){return\"0\"+time;}else{return time;}}function add_month(month){var number_month=new Date(month*1e3).getMonth();return months[number_month-1];}var blueBackground={backgroundColor:'var(--accent)'};var Ticket=/*#__PURE__*/function(_React$Component){_inherits(Ticket,_React$Component);var _super=_createSuper(Ticket);function Ticket(props){var _this;_classCallCheck(this,Ticket);_this=_super.call(this,props);_this.state={api_url:\"https://xelene.ru/road/php/index.php?\",tiket_info:null,tiket_message:[],tiket_send_message:'',add_comment:false,redaction:false,limitreach:false,snackbar:null};var propsbi=_this.props.this;_this.setPopout=propsbi.setPopout;_this.showErrorAlert=propsbi.showErrorAlert;_this.setActiveModal=propsbi.setActiveModal;_this.goOtherProfile=propsbi.goOtherProfile;_this.sendRayt=_this.sendRayt.bind(_assertThisInitialized(_this));_this.onChange=function(event){var name=event.currentTarget.name;var value=event.currentTarget.value;_this.setState(_defineProperty({},name,value));};_this.setSnack=function(value){_this.setState({snackbar:value});};return _this;}_createClass(Ticket,[{key:\"Prepare_ticket\",value:function Prepare_ticket(){var _this2=this;fetch(this.state.api_url+\"method=ticket.getById&\"+window.location.search.replace('?',''),{method:'post',headers:{\"Content-type\":\"application/json; charset=UTF-8\"},// signal: controllertime.signal,\nbody:JSON.stringify({'ticket_id':this.props.ticket_id})}).then(function(res){return res.json();}).then(function(data){if(data.result){_this2.setState({tiket_info:data.response.info,tiket_message:data.response.messages,limitreach:data.response.limitReach});_this2.setPopout(null);}else{_this2.showErrorAlert(data.error.message,function(){return window.history.back();});}}).catch(function(err){_this2.showErrorAlert('Ошибка запроса. Пожалуйста, попробуйте позже',function(){_this2.props.this.changeData('activeStory','disconnect');});});}},{key:\"sendRayt\",value:function sendRayt(mark,message_id){var _this3=this;var reyt=1;if(mark===true){reyt=1;}else{reyt=0;}if(reyt<2){fetch(this.state.api_url+\"method=ticket.markMessage&\"+window.location.search.replace('?',''),{method:'post',headers:{\"Content-type\":\"application/json; charset=UTF-8\"},// signal: controllertime.signal,\nbody:JSON.stringify({'message_id':message_id,'mark':reyt})}).then(function(res){return res.json();}).then(function(data){if(data.result){_this3.getMessages();}else{_this3.showErrorAlert(data.error.message);}}).catch(function(err){_this3.showErrorAlert('Ошибка запроса. Пожалуйста, попробуйте позже',function(){_this3.props.this.changeData('activeStory','disconnect');});});}}},{key:\"sendClear\",value:function sendClear(id){var _this4=this;this.setPopout(/*#__PURE__*/React.createElement(ScreenSpinner,null));fetch(this.state.api_url+\"method=ticket.approveReply&\"+window.location.search.replace('?',''),{method:'post',headers:{\"Content-type\":\"application/json; charset=UTF-8\"},// signal: controllertime.signal,\nbody:JSON.stringify({'message_id':id})}).then(function(res){return res.json();}).then(function(data){if(data.result){_this4.getMessages();}else{_this4.showErrorAlert(data.error.message);}}).catch(function(err){_this4.showErrorAlert('Ошибка запроса. Пожалуйста, попробуйте позже',function(){_this4.props.this.changeData('activeStory','disconnect');});});}},{key:\"Admin\",value:function Admin(approved,id,author_id,text,comment){var _this5=this;var avatar=arguments.length>5&&arguments[5]!==undefined?arguments[5]:null;var mark=arguments.length>6&&arguments[6]!==undefined?arguments[6]:-1;if(author_id>0){this.props.this.setPopout(/*#__PURE__*/React.createElement(ActionSheet,{onClose:function onClose(){return _this5.setPopout(null);}},author_id>0?/*#__PURE__*/React.createElement(ActionSheetItem,{autoclose:true,onClick:function onClick(){_this5.setState({tiket_message:[]});_this5.goOtherProfile(author_id);}},\"\\u041F\\u0440\\u043E\\u0444\\u0438\\u043B\\u044C\"):null,this.props.account.special&&mark!==0&&mark!==1&&author_id>0?/*#__PURE__*/React.createElement(ActionSheetItem,{autoclose:true,onClick:function onClick(){return _this5.sendRayt(true,id);}},\"\\u041E\\u0446\\u0435\\u043D\\u0438\\u0442\\u044C \\u043F\\u043E\\u043B\\u043E\\u0436\\u0438\\u0442\\u0435\\u043B\\u044C\\u043D\\u043E\"):null,this.props.account.special&&mark!==0&&mark!==1&&author_id>0?/*#__PURE__*/React.createElement(ActionSheetItem,{autoclose:true,onClick:function onClick(){return _this5.sendRayt(false,id);}},\"\\u041E\\u0446\\u0435\\u043D\\u0438\\u0442\\u044C \\u043E\\u0442\\u0440\\u0438\\u0446\\u0430\\u0442\\u0435\\u043B\\u044C\\u043D\\u043E\"):null,this.props.account.special===true&&author_id>0&&!approved?/*#__PURE__*/React.createElement(ActionSheetItem,{autoclose:true,onClick:function onClick(){return _this5.sendClear(id);}},\"\\u041E\\u0434\\u043E\\u0431\\u0440\\u0438\\u0442\\u044C\"):null,this.props.account.special===true&&(comment===null||comment===undefined)?/*#__PURE__*/React.createElement(ActionSheetItem,{autoclose:true,onClick:function onClick(){return _this5.setState({add_comment:true,message_id_add:id});}},\"\\u0414\\u043E\\u0431\\u0430\\u0432\\u0438\\u0442\\u044C \\u043A\\u043E\\u043C\\u043C\\u0435\\u043D\\u0442\\u0430\\u0440\\u0438\\u0439\"):null,Number(author_id===this.props.account.id)&&this.state.tiket_info['status']===0&&mark===-1&&!approved?/*#__PURE__*/React.createElement(ActionSheetItem,{autoclose:true,onClick:function onClick(){return _this5.setState({redaction:true,message_id_redac:id,tiket_send_message:text});}},\"\\u0420\\u0435\\u0434\\u0430\\u043A\\u0442\\u0438\\u0440\\u043E\\u0432\\u0430\\u0442\\u044C\"):null,comment===null||comment===undefined?null:/*#__PURE__*/React.createElement(ActionSheetItem,{autoclose:true,onClick:function onClick(){_this5.props.this.setState({comment:comment});_this5.setActiveModal(\"comment\");}},\"\\u041F\\u0440\\u043E\\u0441\\u043C\\u043E\\u0442\\u0440\\u0435\\u0442\\u044C \\u043A\\u043E\\u043C\\u043C\\u0435\\u043D\\u0442\\u0430\\u0440\\u0438\\u0439\"),Number(author_id)===Number(this.props.account.id)||this.props.account.special===true?/*#__PURE__*/React.createElement(ActionSheetItem,{autoclose:true,onClick:function onClick(){return _this5.deleteMessage(id);}},\"\\u0423\\u0434\\u0430\\u043B\\u0438\\u0442\\u044C \\u0441\\u043E\\u043E\\u0431\\u0449\\u0435\\u043D\\u0438\\u0435\"):null,/*#__PURE__*/React.createElement(ActionSheetItem,{autoclose:true,mode:\"cancel\"},\"\\u041E\\u0442\\u043C\\u0435\\u043D\\u0438\\u0442\\u044C\")));}else{if(this.props.account.special){this.props.this.setPopout(/*#__PURE__*/React.createElement(ActionSheet,{onClose:function onClose(){return _this5.setPopout(null);}},/*#__PURE__*/React.createElement(ActionSheetItem,{autoclose:true,onClick:function onClick(){return _this5.deleteMessage(id);}},\"\\u0423\\u0434\\u0430\\u043B\\u0438\\u0442\\u044C \\u0441\\u043E\\u043E\\u0431\\u0449\\u0435\\u043D\\u0438\\u0435\"),/*#__PURE__*/React.createElement(ActionSheetItem,{autoclose:true,onClick:function onClick(){_this5.props.this.setState({other_profile:{'id':author_id,'avatar':{'url':avatar}}});_this5.setActiveModal('ban_user');}},\"\\u0417\\u0430\\u0431\\u0430\\u043D\\u0438\\u0442\\u044C \\u043F\\u043E\\u043B\\u044C\\u0437\\u043E\\u0432\\u0430\\u0442\\u0435\\u043B\\u044F\"),Number(author_id===this.props.account.id)&&this.state.tiket_info['status']===0?/*#__PURE__*/React.createElement(ActionSheetItem,{autoclose:true,onClick:function onClick(){return _this5.setState({redaction:true,message_id_redac:id,tiket_send_message:text});}},\"\\u0420\\u0435\\u0434\\u0430\\u043A\\u0442\\u0438\\u0440\\u043E\\u0432\\u0430\\u0442\\u044C\"):null,/*#__PURE__*/React.createElement(ActionSheetItem,{autoclose:true,mode:\"cancel\"},\"\\u041E\\u0442\\u043C\\u0435\\u043D\\u0438\\u0442\\u044C\")));}else{if(Number(author_id===this.props.account.id)){this.props.this.setPopout(/*#__PURE__*/React.createElement(ActionSheet,{onClose:function onClose(){return _this5.setPopout(null);}},Number(author_id===this.props.account.id)&&this.state.tiket_info['status']===0?/*#__PURE__*/React.createElement(ActionSheetItem,{autoclose:true,onClick:function onClick(){return _this5.setState({redaction:true,message_id_redac:id,tiket_send_message:text});}},\"\\u0420\\u0435\\u0434\\u0430\\u043A\\u0442\\u0438\\u0440\\u043E\\u0432\\u0430\\u0442\\u044C\"):null,/*#__PURE__*/React.createElement(ActionSheetItem,{autoclose:true,mode:\"cancel\"},\"\\u041E\\u0442\\u043C\\u0435\\u043D\\u0438\\u0442\\u044C\")));}}}}},{key:\"copy\",value:function copy(id){var _this6=this;this.props.this.setPopout(/*#__PURE__*/React.createElement(ActionSheet,{onClose:function onClose(){return _this6.setPopout(null);}},Number(this.state.tiket_info['author']['id'])===Number(parsedHash.vk_user_id)?this.state.tiket_info['status']===0||this.state.tiket_info['status']===1?/*#__PURE__*/React.createElement(ActionSheetItem,{autoclose:true,onClick:function onClick(){return _this6.deleteTicket();}},\"\\u0417\\u0430\\u043A\\u0440\\u044B\\u0442\\u044C \\u0442\\u0438\\u043A\\u0435\\u0442\"):/*#__PURE__*/React.createElement(ActionSheetItem,{autoclose:true,onClick:function onClick(){return _this6.openTicket();}},\"\\u041E\\u0442\\u043A\\u0440\\u044B\\u0442\\u044C \\u0442\\u0438\\u043A\\u0435\\u0442\"):this.props.account.special===true?this.state.tiket_info['status']===0||this.state.tiket_info['status']===1?/*#__PURE__*/React.createElement(ActionSheetItem,{autoclose:true,onClick:function onClick(){return _this6.deleteTicket();}},\"\\u0417\\u0430\\u043A\\u0440\\u044B\\u0442\\u044C \\u0442\\u0438\\u043A\\u0435\\u0442\"):/*#__PURE__*/React.createElement(ActionSheetItem,{autoclose:true,onClick:function onClick(){return _this6.openTicket();}},\"\\u041E\\u0442\\u043A\\u0440\\u044B\\u0442\\u044C \\u0442\\u0438\\u043A\\u0435\\u0442\"):null,/*#__PURE__*/React.createElement(ActionSheetItem,{autoclose:true,onClick:function onClick(){bridge.send(\"VKWebAppCopyText\",{text:\"https://vk.com/app7409818#ticket_id=\"+id});_this6.setSnack(/*#__PURE__*/React.createElement(Snackbar,{layout:\"vertical\",before:/*#__PURE__*/React.createElement(Avatar,{size:24,style:blueBackground},/*#__PURE__*/React.createElement(Icon16CheckCircle,{fill:\"#fff\",width:14,height:14})),onClose:function onClose(){return _this6.setSnack(null);}},\"\\u0421\\u0441\\u044B\\u043B\\u043A\\u0430 \\u0441\\u043A\\u043E\\u043F\\u0438\\u0440\\u043E\\u0432\\u0430\\u043D\\u0430\"));}},\"\\u0421\\u043A\\u043E\\u043F\\u0438\\u0440\\u043E\\u0432\\u0430\\u0442\\u044C \\u0441\\u0441\\u044B\\u043B\\u043A\\u0443\"),/*#__PURE__*/React.createElement(ActionSheetItem,{autoclose:true,mode:\"cancel\"},\"\\u041E\\u0442\\u043C\\u0435\\u043D\\u0438\\u0442\\u044C\")));}},{key:\"clickable_user_message\",value:function clickable_user_message(author_id){console.log(author_id);var clickable=true;if(author_id<0){if(!this.props.account.special){if(!Boolean(Number(author_id===this.props.account.id))){clickable=false;}}}return clickable;}},{key:\"sendNewMessage\",value:function sendNewMessage(){var _this7=this;this.setPopout(/*#__PURE__*/React.createElement(ScreenSpinner,null));fetch(this.state.api_url+'method=ticket.sendMessage&'+window.location.search.replace('?',''),{method:'post',headers:{\"Content-type\":\"application/json; charset=UTF-8\"},// signal: controllertime.signal,\nbody:JSON.stringify({'ticket_id':this.state.tiket_info['id'],'text':this.state.tiket_send_message.trim()})}).then(function(res){return res.json();}).then(function(data){if(data.result){_this7.getMessages();}else{_this7.showErrorAlert(data.error.message);}}).catch(function(err){_this7.showErrorAlert('Ошибка запроса. Пожалуйста, попробуйте позже',function(){_this7.props.this.changeData('activeStory','disconnect');});});}},{key:\"deleteMessage\",value:function deleteMessage(message_id){var _this8=this;this.setPopout(/*#__PURE__*/React.createElement(ScreenSpinner,null));fetch(this.state.api_url+\"method=ticket.deleteMessage&\"+window.location.search.replace('?',''),{method:'post',headers:{\"Content-type\":\"application/json; charset=UTF-8\"},// signal: controllertime.signal,\nbody:JSON.stringify({'message_id':message_id})}).then(function(res){return res.json();}).then(function(data){if(data.result){_this8.getMessages();}else{_this8.showErrorAlert(data.error.message);}}).catch(function(err){_this8.showErrorAlert('Ошибка запроса. Пожалуйста, попробуйте позже',function(){_this8.props.this.changeData('activeStory','disconnect');});});}},{key:\"deleteTicket\",value:function deleteTicket(){var _this9=this;this.setPopout(/*#__PURE__*/React.createElement(ScreenSpinner,null));fetch(this.state.api_url+\"method=ticket.close&\"+window.location.search.replace('?',''),{method:'post',headers:{\"Content-type\":\"application/json; charset=UTF-8\"},// signal: controllertime.signal,\nbody:JSON.stringify({'ticket_id':this.state.tiket_info['id']})}).then(function(res){return res.json();}).then(function(data){if(data.result){_this9.getMessages();}else{_this9.showErrorAlert(data.error.message);}}).catch(function(err){_this9.showErrorAlert('Ошибка запроса. Пожалуйста, попробуйте позже',function(){_this9.props.this.changeData('activeStory','disconnect');});});}},{key:\"openTicket\",value:function openTicket(){var _this10=this;this.setPopout(/*#__PURE__*/React.createElement(ScreenSpinner,null));fetch(this.state.api_url+\"method=ticket.open&\"+window.location.search.replace('?',''),{method:'post',headers:{\"Content-type\":\"application/json; charset=UTF-8\"},// signal: controllertime.signal,\nbody:JSON.stringify({'ticket_id':this.state.tiket_info['id']})}).then(function(res){return res.json();}).then(function(data){if(data.result){_this10.getMessages();}else{_this10.showErrorAlert(data.error.message);}}).catch(function(err){_this10.showErrorAlert('Ошибка запроса. Пожалуйста, попробуйте позже',function(){_this10.props.this.changeData('activeStory','disconnect');});});}},{key:\"sendNewMessageRedact\",value:function sendNewMessageRedact(){var _this11=this;this.setPopout(/*#__PURE__*/React.createElement(ScreenSpinner,null));fetch(this.state.api_url+'method=ticket.editMessage&'+window.location.search.replace('?',''),{method:'post',headers:{\"Content-type\":\"application/json; charset=UTF-8\"},// signal: controllertime.signal,\nbody:JSON.stringify({'message_id':this.state.message_id_redac,'text':this.state.tiket_send_message.trim()})}).then(function(res){return res.json();}).then(function(data){if(data.result){_this11.getMessages();}else{_this11.showErrorAlert(data.error.message);}}).catch(function(err){_this11.showErrorAlert('Ошибка запроса. Пожалуйста, попробуйте позже',function(){_this11.props.this.changeData('activeStory','disconnect');});});}},{key:\"sendNewMessageComment\",value:function sendNewMessageComment(){var _this12=this;this.setPopout(/*#__PURE__*/React.createElement(ScreenSpinner,null));fetch(this.state.api_url+'method=ticket.commentMessage&'+window.location.search.replace('?',''),{method:'post',headers:{\"Content-type\":\"application/json; charset=UTF-8\"},// signal: controllertime.signal,\nbody:JSON.stringify({'message_id':this.state.message_id_add,'text':this.state.tiket_send_message.trim()})}).then(function(res){return res.json();}).then(function(data){if(data.result){_this12.getMessages();}else{_this12.showErrorAlert(data.error.message);}}).catch(function(err){_this12.showErrorAlert('Ошибка запроса. Пожалуйста, попробуйте позже',function(){_this12.props.this.changeData('activeStory','disconnect');});});}},{key:\"getMessages\",value:function getMessages(){var _this13=this;fetch(this.state.api_url+\"method=ticket.getMessages&\"+window.location.search.replace('?',''),{method:'post',headers:{\"Content-type\":\"application/json; charset=UTF-8\"},// signal: controllertime.signal,\nbody:JSON.stringify({'ticket_id':this.state.tiket_info['id']})}).then(function(res){return res.json();}).then(function(data){if(data.result){_this13.setState({tiket_message:data.response.messages,tiket_send_message:\"\",add_comment:false,redaction:false,limitreach:data.response.limitReach});_this13.setPopout(null);}else{_this13.showErrorAlert(data.error.message);}}).catch(function(err){_this13.showErrorAlert('Ошибка запроса. Пожалуйста, попробуйте позже',function(){_this13.props.this.changeData('activeStory','disconnect');});});}},{key:\"componentDidMount\",value:function componentDidMount(){this.setPopout(/*#__PURE__*/React.createElement(ScreenSpinner,null));this.Prepare_ticket();}},{key:\"nofinc\",value:function nofinc(){return 1;}},{key:\"render\",value:function render(){var _this14=this;var props=this.props;var thisOb=this;return/*#__PURE__*/React.createElement(Panel,{id:this.props.id},/*#__PURE__*/React.createElement(PanelHeader,{left:/*#__PURE__*/React.createElement(PanelHeaderBack,{onClick:function onClick(){return window.history.back();}})},this.state.tiket_info?/*#__PURE__*/React.createElement(\"span\",{id:\"animation\",className:\"pointer\",onClick:function onClick(){return _this14.copy(_this14.state.tiket_info['id']);}},\"\\u0412\\u043E\\u043F\\u0440\\u043E\\u0441 #\",this.state.tiket_info['id']):null),this.state.tiket_info?/*#__PURE__*/React.createElement(React.Fragment,null,/*#__PURE__*/React.createElement(\"div\",{className:\"title_tiket\"},new Date(this.state.tiket_info['time']*1e3).getDate(),\" \",add_month(this.state.tiket_info['time'])),/*#__PURE__*/React.createElement(\"div\",{className:\"title_tiket\",style:{marginTop:\"10px\",width:\"95%\",marginLeft:\"10px\"}},\"\\u041F\\u043E\\u043B\\u044C\\u0437\\u043E\\u0432\\u0430\\u0442\\u0435\\u043B\\u044C \\u043E\\u0431\\u0440\\u0430\\u0442\\u0438\\u043B\\u0441\\u044F \\u0441 \\u0432\\u043E\\u043F\\u0440\\u043E\\u0441\\u043E\\u043C  \\xAB\",this.state.tiket_info['title'],\"\\xBB\"),/*#__PURE__*/React.createElement(React.Fragment,null,this.state.tiket_message?this.state.tiket_message.map(function(result,i){var is_mine_ticket=Number(thisOb.state.tiket_info.author['id'])===Number(parsedHash.vk_user_id)?true:false;var is_mine_message=Number(result['author']['id'])===Number(parsedHash.vk_user_id)?true:false;var avatar=result.author.is_moderator?result['author']['avatar']['url']:result.author.photo_200;var time=fix_time(new Date(result.time*1e3).getHours())+\":\"+fix_time(new Date(result.time*1e3).getMinutes());var title_moder=isFinite(result['nickname'])?\"\\u0410\\u0433\\u0435\\u043D\\u0442 \\u041F\\u043E\\u0434\\u0434\\u0435\\u0440\\u0436\\u043A\\u0438 #\".concat(result['nickname']):result['nickname']?result['nickname']:\"\\u0410\\u0433\\u0435\\u043D\\u0442 \\u041F\\u043E\\u0434\\u0434\\u0435\\u0440\\u0436\\u043A\\u0438 #\".concat(result['author']['id']);return Number(thisOb.state.tiket_info.author['id'])===Number(parsedHash.vk_user_id)?/*#__PURE__*/React.createElement(Message,{clickable:true,title:result.author.is_moderator?title_moder:result.author.first_name+\" \"+result.author.last_name,title_icon:result.moderator_comment!==undefined?/*#__PURE__*/React.createElement(Icon16ReplyOutline,{width:10,height:10,style:{display:\"inline-block\"}}):false,is_mine:is_mine_message===is_mine_ticket,avatar:avatar,onClick:function onClick(){return thisOb.Admin(result['approved'],result['id'],result['author'].first_name?-result['author']['id']:result['author']['id'],result['text'],result.moderator_comment!==undefined?result['moderator_comment']['text']:null,avatar,result['mark']);},key:i,is_special:thisOb.props.account.special,is_mark:result.mark,time:time,sendRayt_false:function sendRayt_false(){return thisOb.sendRayt(false,result.id);},sendRayt_true:function sendRayt_true(){return thisOb.sendRayt(true,result.id);},approved:result.approved?true:false,CanselApp:function CanselApp(){return props.this.showAlert('Информация','Этот ответ оценен отрицательно');},DoneApp:function DoneApp(){return props.this.showAlert('Информация','Этот ответ оценен положительно');}},result.text):/*#__PURE__*/React.createElement(Message,{clickable:!thisOb.props.account.special?false:true,title:result.author.is_moderator?title_moder:result.author.first_name+\" \"+result.author.last_name,title_icon:result.moderator_comment!==undefined?/*#__PURE__*/React.createElement(Icon16ReplyOutline,{width:10,height:10,style:{display:\"inline-block\"}}):false,is_mine:result.author.is_moderator,avatar:avatar,key:i,time:time,onClick:function onClick(){return thisOb.Admin(result['approved'],result['id'],result['author'].first_name?-result['author']['id']:result['author']['id'],result['text'],result.moderator_comment!==undefined?result['moderator_comment']['text']:null,avatar,result['mark']);},is_special:thisOb.props.account.special,is_mark:result.mark,sendRayt_false:function sendRayt_false(){return thisOb.sendRayt(false,result.id);},sendRayt_true:function sendRayt_true(){return thisOb.sendRayt(true,result.id);},approved:result.approved?true:false,CanselApp:function CanselApp(){return props.this.showAlert('Информация','Этот ответ оценен отрицательно');},DoneApp:function DoneApp(){return props.this.showAlert('Информация','Этот ответ оценен положительно');}},result.text);}):null,!(this.state.tiket_info['status']===1||this.state.tiket_info['status']===2)?/*#__PURE__*/React.createElement(\"div\",{style:{marginBottom:'20vh'}}):/*#__PURE__*/React.createElement(\"div\",{style:{marginBottom:'5vh'}})),this.state.tiket_info['status']===0||this.state.redaction===true||this.state.add_comment===true?this.state.limitreach&&!(this.state.redaction||this.state.add_comment)?/*#__PURE__*/React.createElement(FixedLayout,{filled:true,vertical:\"bottom\"},/*#__PURE__*/React.createElement(Div,null,/*#__PURE__*/React.createElement(FormStatus,{header:\"\\u0412\\u043D\\u0438\\u043C\\u0430\\u043D\\u0438\\u0435!\",mode:\"default\"},\"\\u0412\\u044B \\u0438\\u0441\\u0447\\u0435\\u0440\\u043F\\u0430\\u043B\\u0438 \\u043B\\u0438\\u043C\\u0438\\u0442 \\u0441\\u043E\\u043E\\u0431\\u0449\\u0435\\u043D\\u0438\\u0439 \\u0432 \\u044D\\u0442\\u043E\\u0442 \\u0442\\u0438\\u043A\\u0435\\u0442.\"))):/*#__PURE__*/React.createElement(FixedLayout,{vertical:\"bottom\"},/*#__PURE__*/React.createElement(Separator,{wide:true}),/*#__PURE__*/React.createElement(WriteBar,{after:/*#__PURE__*/React.createElement(React.Fragment,null,/*#__PURE__*/React.createElement(WriteBarIcon,{mode:this.state.redaction?'done':\"send\",disabled:!(this.state.tiket_send_message.trim().length>=5),onClick:function onClick(){_this14.state.tiket_send_message.trim().length>=5?_this14.state.redaction!==true&&_this14.state.add_comment!==true?_this14.sendNewMessage():_this14.state.redaction?_this14.sendNewMessageRedact():_this14.sendNewMessageComment():_this14.nofinc();}})),value:this.state.tiket_send_message,maxLength:\"2020\",name:\"tiket_send_message\",onChange:function onChange(e){return _this14.onChange(e);},placeholder:\"\\u0421\\u043E\\u043E\\u0431\\u0449\\u0435\\u043D\\u0438\\u0435\"})):null,this.state.tiket_info['status']===1?Number(this.state.tiket_info['author']['id'])===Number(parsedHash.vk_user_id)?/*#__PURE__*/React.createElement(\"div\",null,/*#__PURE__*/React.createElement(FixedLayout,{vertical:\"bottom\"},/*#__PURE__*/React.createElement(Div,{style:{display:\"flex\"}},/*#__PURE__*/React.createElement(Button,{size:\"l\",style:{marginRight:\"5%\"},stretched:true,onClick:function onClick(){return _this14.deleteTicket();}},\"\\u041F\\u0440\\u043E\\u0431\\u043B\\u0435\\u043C\\u0430 \\u0440\\u0435\\u0448\\u0435\\u043D\\u0430\"),/*#__PURE__*/React.createElement(Button,{size:\"l\",stretched:true,mode:\"secondary\",onClick:function onClick(){return _this14.openTicket();}},\"\\u041F\\u0440\\u043E\\u0431\\u043B\\u0435\\u043C\\u0430 \\u043D\\u0435 \\u0440\\u0435\\u0448\\u0435\\u043D\\u0430\")))):null:null,this.state.snackbar):null);}}]);return Ticket;}(React.Component);export{Ticket as default};;","map":{"version":3,"sources":["C:/Users/rshub/Desktop/Road-to-Jedi/mobile-road/src/components/tiket.js"],"names":["React","bridge","Panel","PanelHeader","Button","FixedLayout","Div","ScreenSpinner","ActionSheet","ActionSheetItem","PanelHeaderBack","Separator","WriteBarIcon","WriteBar","FormStatus","Snackbar","Avatar","Icon16ReplyOutline","Icon16CheckCircle","Message","queryString","require","parsedHash","parse","window","location","search","replace","months","fix_time","time","add_month","month","number_month","Date","getMonth","blueBackground","backgroundColor","Ticket","props","state","api_url","tiket_info","tiket_message","tiket_send_message","add_comment","redaction","limitreach","snackbar","propsbi","this","setPopout","showErrorAlert","setActiveModal","goOtherProfile","sendRayt","bind","onChange","event","name","currentTarget","value","setState","setSnack","fetch","method","headers","body","JSON","stringify","ticket_id","then","res","json","data","result","response","info","messages","limitReach","error","message","history","back","catch","err","changeData","mark","message_id","reyt","getMessages","id","approved","author_id","text","comment","avatar","account","special","sendClear","undefined","message_id_add","Number","message_id_redac","deleteMessage","other_profile","vk_user_id","deleteTicket","openTicket","send","console","log","clickable","Boolean","trim","Prepare_ticket","thisOb","copy","getDate","marginTop","width","marginLeft","map","i","is_mine_ticket","author","is_mine_message","is_moderator","photo_200","getHours","getMinutes","title_moder","isFinite","first_name","last_name","moderator_comment","display","Admin","showAlert","marginBottom","length","sendNewMessage","sendNewMessageRedact","sendNewMessageComment","nofinc","e","marginRight","Component"],"mappings":"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","sourcesContent":["import React from 'react';\nimport bridge from '@vkontakte/vk-bridge'; // VK Brige\n\nimport { \n    Panel,\n    PanelHeader,\n    Button,\n    FixedLayout,\n    Div,\n    ScreenSpinner,\n    ActionSheet,\n    ActionSheetItem,\n    PanelHeaderBack,\n    Separator,\n    WriteBarIcon,\n    WriteBar,\n    FormStatus,\n    Snackbar,\n    Avatar,\n    } from '@vkontakte/vkui';\n\nimport Icon16ReplyOutline from '@vkontakte/icons/dist/16/reply_outline';\nimport Icon16CheckCircle from '@vkontakte/icons/dist/16/check_circle';\n\n// import Ninja from '../images/Ninja.webp'\n\nimport Message from './message'\n// const platformname = (/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent));\nconst queryString = require('query-string');\nconst parsedHash = queryString.parse(window.location.search.replace('?', ''));\n\nvar months = [\n    'января',\n    'февраля',\n    'марта',\n    'апреля',\n    'мая',\n    'июня',\n    'июля',\n    'августа',\n    'сентября',\n    'ноября',\n    'декабря',\n];\n\nfunction fix_time(time) {\n    if(time < 10) {\n        return \"0\" + time\n    } else {\n        return time\n    }\n}\n\nfunction add_month(month) {\n    let number_month = new Date(month * 1e3).getMonth()\n    return months[number_month - 1]\n}\nconst blueBackground = {\n  backgroundColor: 'var(--accent)'\n};\nexport default class Ticket extends React.Component {\n    constructor(props) {\n        super(props);\n        this.state = {\n            api_url: \"https://xelene.ru/road/php/index.php?\",\n            tiket_info: null,\n            tiket_message: [],\n            tiket_send_message: '',\n            add_comment: false,\n            redaction: false,\n            limitreach: false,\n            snackbar: null,\n        }\n        var propsbi = this.props.this;\n        this.setPopout = propsbi.setPopout;\n        this.showErrorAlert = propsbi.showErrorAlert;\n        this.setActiveModal = propsbi.setActiveModal;\n        this.goOtherProfile = propsbi.goOtherProfile;\n        this.sendRayt = this.sendRayt.bind(this);\n        this.onChange = (event) => {\n          var name = event.currentTarget.name;\n          var value = event.currentTarget.value;\n          this.setState({ [name]: value });\n        }\n        this.setSnack = (value) => {\n          this.setState({snackbar: value})\n        }\n\n    }\n    Prepare_ticket(){\n        fetch(this.state.api_url + \"method=ticket.getById&\" + window.location.search.replace('?', ''),\n        {method: 'post',\n      headers: {\"Content-type\": \"application/json; charset=UTF-8\"},\n          // signal: controllertime.signal,\n      body: JSON.stringify({\n        'ticket_id': this.props.ticket_id,\n\n    })\n      })\n        .then(res => res.json())\n        .then(data => {\n          if(data.result) {\n            this.setState({tiket_info: data.response.info,\n              tiket_message: data.response.messages,limitreach: data.response.limitReach });\n              this.setPopout(null);\n          } else {\n            this.showErrorAlert(data.error.message,() => window.history.back())\n          }\n        })\n        .catch(err => {\n          this.showErrorAlert('Ошибка запроса. Пожалуйста, попробуйте позже',() => {this.props.this.changeData('activeStory', 'disconnect')})\n        })\n    }\n    sendRayt(mark, message_id) {\n        let reyt = 1;\n        if(mark === true) {\n          reyt = 1;\n        } else {\n          reyt = 0;\n        }\n        if(reyt < 2) {\n          fetch(this.state.api_url + \"method=ticket.markMessage&\" + window.location.search.replace('?', ''),\n          {method: 'post',\n          headers: {\"Content-type\": \"application/json; charset=UTF-8\"},\n          // signal: controllertime.signal,\n          body: JSON.stringify({\n            'message_id': message_id,\n            'mark': reyt,\n          })\n            })\n            .then(res => res.json())\n            .then(data => {\n              if(data.result) {\n                this.getMessages()\n              }else {\n                this.showErrorAlert(data.error.message)\n              }\n            })\n            .catch(err => {\n              this.showErrorAlert('Ошибка запроса. Пожалуйста, попробуйте позже',() => {this.props.this.changeData('activeStory', 'disconnect')})\n            \n            })\n        }\n      }\n      sendClear(id) {\n        this.setPopout(<ScreenSpinner/>)\n        fetch(this.state.api_url + \"method=ticket.approveReply&\" + window.location.search.replace('?', ''),\n        {method: 'post',\n          headers: {\"Content-type\": \"application/json; charset=UTF-8\"},\n          // signal: controllertime.signal,\n          body: JSON.stringify({\n            'message_id': id,\n          })\n            })\n          .then(res => res.json())\n          .then(data => {\n            if(data.result) {\n              this.getMessages()\n            } else {\n              this.showErrorAlert(data.error.message)\n            }\n          })\n          .catch(err => {\n            this.showErrorAlert('Ошибка запроса. Пожалуйста, попробуйте позже',() => {this.props.this.changeData('activeStory', 'disconnect')})\n    \n          })\n      }\n      Admin(approved, id, author_id, text, comment,avatar=null, mark = -1){\n        if(author_id > 0){\n          this.props.this.setPopout(\n            <ActionSheet onClose={() => this.setPopout(null)}>\n               {author_id > 0 ?\n              <ActionSheetItem autoclose onClick={() => {this.setState({tiket_message: []});this.goOtherProfile(author_id);}}>\n                Профиль\n              </ActionSheetItem>\n              : null}\n             { this.props.account.special && mark !== 0 && mark !== 1 && author_id > 0 ? \n              <ActionSheetItem autoclose onClick={() => this.sendRayt(true, id)}>\n                Оценить положительно\n              </ActionSheetItem> \n              : null}\n              { this.props.account.special && mark !== 0 && mark !== 1 && author_id > 0 ? \n              <ActionSheetItem autoclose onClick={() => this.sendRayt(false, id)}>\n                Оценить отрицательно\n              </ActionSheetItem> \n              : null }\n              { (this.props.account.special === true && author_id > 0 && !approved) ? \n              <ActionSheetItem autoclose onClick={() => this.sendClear(id)}>\n                Одобрить\n              </ActionSheetItem> \n              : null }\n              {(this.props.account.special === true && (comment === null || comment === undefined)) ? \n              <ActionSheetItem autoclose onClick={() => this.setState({add_comment: true, message_id_add: id})}>\n              Добавить комментарий\n              </ActionSheetItem> \n              : null }\n              {(Number(author_id === this.props.account.id) && this.state.tiket_info['status'] === 0 && mark === -1 && !approved) ? \n             <ActionSheetItem autoclose onClick={() => this.setState({redaction: true, message_id_redac: id, tiket_send_message: text})}>\n             Редактировать\n             </ActionSheetItem>\n             : null}\n          {(comment === null || comment === undefined) ? null : \n              <ActionSheetItem autoclose onClick={() => {this.props.this.setState({comment: comment}); this.setActiveModal(\"comment\")}}>\n              Просмотреть комментарий\n            </ActionSheetItem>}\n              {Number(author_id) === Number(this.props.account.id) || this.props.account.special === true ? \n              <ActionSheetItem autoclose onClick={() => this.deleteMessage(id)}>\n                Удалить сообщение\n              </ActionSheetItem>\n              : null}\n              {<ActionSheetItem autoclose mode=\"cancel\">Отменить</ActionSheetItem>}\n            </ActionSheet>\n          )\n        }else{\n          if(this.props.account.special){\n            \n            this.props.this.setPopout(\n              <ActionSheet onClose={() => this.setPopout(null)}>\n                <ActionSheetItem autoclose onClick={() => this.deleteMessage(id)}>\n                  Удалить сообщение\n                </ActionSheetItem>\n                <ActionSheetItem autoclose onClick={() => {this.props.this.setState({other_profile:{'id':author_id,'avatar': {'url': avatar}}});this.setActiveModal('ban_user');}}>\n                  Забанить пользователя\n                </ActionSheetItem> \n                {(Number(author_id === this.props.account.id) && this.state.tiket_info['status'] === 0) ? \n               <ActionSheetItem autoclose onClick={() => this.setState({redaction: true, message_id_redac: id, tiket_send_message: text})}>\n               Редактировать\n               </ActionSheetItem>\n               : null}\n              {<ActionSheetItem autoclose mode=\"cancel\">Отменить</ActionSheetItem>}\n              </ActionSheet>\n            )\n          }else{\n            if(Number(author_id === this.props.account.id)){\n              this.props.this.setPopout(\n                <ActionSheet onClose={() => this.setPopout(null)}>\n                  {(Number(author_id === this.props.account.id) && this.state.tiket_info['status'] === 0) ? \n                 <ActionSheetItem autoclose onClick={() => this.setState({redaction: true, message_id_redac: id, tiket_send_message: text})}>\n                 Редактировать\n                 </ActionSheetItem>\n                 : null}\n                {<ActionSheetItem autoclose mode=\"cancel\">Отменить</ActionSheetItem>}\n                </ActionSheet>\n              )\n            }\n            \n          }\n          \n        }\n        \n      }\n      copy(id) {\n        this.props.this.setPopout(\n          <ActionSheet onClose={() => this.setPopout(null)}>\n            {Number(this.state.tiket_info['author']['id']) === Number(parsedHash.vk_user_id) ? \n            this.state.tiket_info['status'] === 0 ||  this.state.tiket_info['status'] === 1 ?\n            <ActionSheetItem autoclose onClick={() => this.deleteTicket()}>\n            Закрыть тикет\n            </ActionSheetItem>\n            : \n            <ActionSheetItem autoclose onClick={() => this.openTicket()}>\n            Открыть тикет\n            </ActionSheetItem>\n            : \n            this.props.account.special === true ?\n            this.state.tiket_info['status'] === 0 ||  this.state.tiket_info['status'] === 1 ?\n            <ActionSheetItem autoclose onClick={() => this.deleteTicket()}>\n            Закрыть тикет\n            </ActionSheetItem>\n            : \n            <ActionSheetItem autoclose onClick={() => this.openTicket()}>\n            Открыть тикет\n            </ActionSheetItem>\n            : null\n          }\n            <ActionSheetItem autoclose onClick={() => {\n              bridge.send(\"VKWebAppCopyText\", {text: \"https://vk.com/app7409818#ticket_id=\" + id});\n              this.setSnack(<Snackbar\n                layout=\"vertical\"\n                before={<Avatar size={24} style={blueBackground}><Icon16CheckCircle fill=\"#fff\" width={14} height={14} /></Avatar>}\n                onClose={() => this.setSnack(null)}>\n                  Ссылка скопирована\n                </Snackbar>)\n          }}>\n              Скопировать ссылку\n            </ActionSheetItem>\n            {<ActionSheetItem autoclose mode=\"cancel\">Отменить</ActionSheetItem>}\n          </ActionSheet>)\n      }\n      clickable_user_message(author_id){\n        console.log(author_id)\n        let clickable = true;\n        if(author_id < 0){\n          if(!this.props.account.special){\n            if(!Boolean(Number(author_id === this.props.account.id))){\n              clickable = false;\n            }\n          }\n        }\n        return clickable;\n      }\n      sendNewMessage() {\n        this.setPopout(<ScreenSpinner/>)\n          fetch(this.state.api_url + 'method=ticket.sendMessage&' + window.location.search.replace('?', ''),\n          {method: 'post',\n          headers: {\"Content-type\": \"application/json; charset=UTF-8\"},\n          // signal: controllertime.signal,\n          body: JSON.stringify({\n            'ticket_id': this.state.tiket_info['id'],\n            'text': this.state.tiket_send_message.trim(),\n          })\n            })\n          .then(res => res.json())\n          .then(data => {\n            if(data.result) {\n              this.getMessages()\n            }else {\n              this.showErrorAlert(data.error.message)\n            }\n          })\n          .catch(err => {\n            this.showErrorAlert('Ошибка запроса. Пожалуйста, попробуйте позже',() => {this.props.this.changeData('activeStory', 'disconnect')})\n\n          })\n      }\n      deleteMessage(message_id) {\n        this.setPopout(<ScreenSpinner/>)\n          fetch(this.state.api_url + \"method=ticket.deleteMessage&\" + window.location.search.replace('?', ''),\n          {method: 'post',\n          headers: {\"Content-type\": \"application/json; charset=UTF-8\"},\n          // signal: controllertime.signal,\n          body: JSON.stringify({\n            'message_id': message_id,\n          })\n            })\n            .then(res => res.json())\n            .then(data => {\n              if(data.result) {\n                this.getMessages()\n              }else {\n                this.showErrorAlert(data.error.message)\n              }\n            })\n            .catch(err => {\n              this.showErrorAlert('Ошибка запроса. Пожалуйста, попробуйте позже',() => {this.props.this.changeData('activeStory', 'disconnect')})\n  \n            })\n      }\n      deleteTicket() {\n        this.setPopout(<ScreenSpinner/>)\n        fetch(this.state.api_url + \"method=ticket.close&\" + window.location.search.replace('?', ''),\n        {method: 'post',\n          headers: {\"Content-type\": \"application/json; charset=UTF-8\"},\n          // signal: controllertime.signal,\n          body: JSON.stringify({\n            'ticket_id': this.state.tiket_info['id'],\n\n          })\n            })\n          .then(res => res.json())\n          .then(data => {\n            if(data.result) {\n              this.getMessages()\n            }else {\n              this.showErrorAlert(data.error.message)\n            }\n          })\n          .catch(err => {\n            this.showErrorAlert('Ошибка запроса. Пожалуйста, попробуйте позже',() => {this.props.this.changeData('activeStory', 'disconnect')})\n  \n          })\n      }\n      openTicket() {\n        this.setPopout(<ScreenSpinner/>)\n        fetch(this.state.api_url + \"method=ticket.open&\" + window.location.search.replace('?', ''),\n        {method: 'post',\n          headers: {\"Content-type\": \"application/json; charset=UTF-8\"},\n          // signal: controllertime.signal,\n          body: JSON.stringify({\n            'ticket_id': this.state.tiket_info['id'],\n          })\n            })\n          .then(res => res.json())\n          .then(data => {\n            if(data.result) {\n              this.getMessages()\n            }else {\n              this.showErrorAlert(data.error.message)\n            }\n          })\n          .catch(err => {\n            this.showErrorAlert('Ошибка запроса. Пожалуйста, попробуйте позже',() => {this.props.this.changeData('activeStory', 'disconnect')})\n  \n          })\n      }\n      sendNewMessageRedact() {\n        this.setPopout(<ScreenSpinner/>)\n        fetch(this.state.api_url + 'method=ticket.editMessage&' + window.location.search.replace('?', ''),\n        {method: 'post',\n          headers: {\"Content-type\": \"application/json; charset=UTF-8\"},\n          // signal: controllertime.signal,\n          body: JSON.stringify({\n            'message_id': this.state.message_id_redac,\n            'text': this.state.tiket_send_message.trim(),\n          })\n            })\n          .then(res => res.json())\n          .then(data => {\n            if(data.result) {\n              this.getMessages()\n            }else {\n              this.showErrorAlert(data.error.message)\n            }\n          })\n          .catch(err => {\n            this.showErrorAlert('Ошибка запроса. Пожалуйста, попробуйте позже',() => {this.props.this.changeData('activeStory', 'disconnect')})\n\n          })\n        \n      }\n      sendNewMessageComment() {\n        this.setPopout(<ScreenSpinner/>)\n        fetch(this.state.api_url + 'method=ticket.commentMessage&' + window.location.search.replace('?', ''),\n        {method: 'post',\n          headers: {\"Content-type\": \"application/json; charset=UTF-8\"},\n          // signal: controllertime.signal,\n          body: JSON.stringify({\n            'message_id': this.state.message_id_add,\n            'text': this.state.tiket_send_message.trim(),\n          })\n            })\n          .then(res => res.json())\n          .then(data => {\n            if(data.result) {\n              this.getMessages()\n            }else {\n              this.showErrorAlert(data.error.message)\n            }\n          })\n          .catch(err => {\n            this.showErrorAlert('Ошибка запроса. Пожалуйста, попробуйте позже',() => {this.props.this.changeData('activeStory', 'disconnect')})\n\n          })\n      }\n    getMessages(){\n      fetch(this.state.api_url + \"method=ticket.getMessages&\" + window.location.search.replace('?', ''),\n      {method: 'post',\n          headers: {\"Content-type\": \"application/json; charset=UTF-8\"},\n          // signal: controllertime.signal,\n          body: JSON.stringify({\n            'ticket_id': this.state.tiket_info['id'],\n          })\n            })\n      .then(res => res.json())\n      .then(data => {\n        if(data.result) {\n          this.setState({tiket_message: data.response.messages, tiket_send_message: \"\",add_comment: false, redaction: false,limitreach: data.response.limitReach})\n          this.setPopout(null)\n        }else {\n          this.showErrorAlert(data.error.message)\n        }\n      })\n      .catch(err => {\n        this.showErrorAlert('Ошибка запроса. Пожалуйста, попробуйте позже',() => {this.props.this.changeData('activeStory', 'disconnect')})\n\n      })\n    }\n    componentDidMount(){\n      this.setPopout(<ScreenSpinner/>)\n      this.Prepare_ticket()\n    }\n    nofinc(){\n      return 1\n    }\n    render(){\n        var props = this.props;\n        var thisOb = this;\n        return(\n        <Panel id={this.props.id}>\n            <PanelHeader \n                left={<PanelHeaderBack onClick={() => window.history.back()} />}\n            >\n                {this.state.tiket_info ? <span id=\"animation\" className='pointer' onClick={() => this.copy(this.state.tiket_info['id'])}>Вопрос #{this.state.tiket_info['id']}</span> : null}\n            </PanelHeader>\n            {/* MESSAGES */}\n            {this.state.tiket_info ? <>\n            <div className=\"title_tiket\">{new Date(this.state.tiket_info['time'] * 1e3).getDate()} {add_month(this.state.tiket_info['time'])}</div>\n            <div className=\"title_tiket\" style={{marginTop: \"10px\", width: \"95%\", marginLeft: \"10px\"}}>Пользователь обратился с вопросом  «{this.state.tiket_info['title']}»</div>\n                    <>{this.state.tiket_message ? this.state.tiket_message.map(function(result, i) {\n                        var is_mine_ticket = Number(thisOb.state.tiket_info.author['id']) === Number(parsedHash.vk_user_id) ? true : false\n                        var is_mine_message = Number(result['author']['id']) === Number(parsedHash.vk_user_id) ? true : false\n                        var avatar = result.author.is_moderator ? result['author']['avatar']['url'] : result.author.photo_200\n                        var time = fix_time(new Date(result.time * 1e3).getHours()) + \":\" + fix_time(new Date(result.time * 1e3).getMinutes())\n                        var title_moder = isFinite(result['nickname']) ? `Агент Поддержки #${result['nickname']}` : result['nickname'] ? result['nickname'] : `Агент Поддержки #${result['author']['id']}`;\n                        return (\n                            Number(thisOb.state.tiket_info.author['id']) === Number(parsedHash.vk_user_id) ?\n                            <Message \n                                clickable={true}\n                                title={result.author.is_moderator ? title_moder : result.author.first_name + \" \" + result.author.last_name} \n                                title_icon={result.moderator_comment !== undefined ? <Icon16ReplyOutline width={10} height={10} style={{display: \"inline-block\"}}/> : false}\n                                is_mine={is_mine_message === is_mine_ticket}\n                                avatar={avatar}\n                                onClick={() => thisOb.Admin(result['approved'],result['id'], result['author'].first_name ? -result['author']['id'] : result['author']['id'] , result['text'], result.moderator_comment !== undefined ? result['moderator_comment']['text'] : null,avatar, result['mark'])}\n                                key={i}\n                                is_special={thisOb.props.account.special}\n                                is_mark={result.mark}\n                                time={time}\n                                sendRayt_false={() => thisOb.sendRayt(false, result.id)}\n                                sendRayt_true={() => thisOb.sendRayt(true, result.id)}\n                                approved={result.approved ? true : false}\n                                CanselApp={() => props.this.showAlert('Информация', 'Этот ответ оценен отрицательно')}\n                                DoneApp={() => props.this.showAlert('Информация', 'Этот ответ оценен положительно')}\n                            >\n                                {result.text}\n                            </Message>\n                            \n                            :\n                            <Message \n                                clickable={!thisOb.props.account.special ? false : true}\n                                title={result.author.is_moderator ? title_moder : result.author.first_name + \" \" + result.author.last_name} \n                                title_icon={result.moderator_comment !== undefined ? <Icon16ReplyOutline width={10} height={10} style={{display: \"inline-block\"}}/> : false}\n                                is_mine={result.author.is_moderator}\n                                avatar={avatar}\n                                key={i}\n                                time={time}\n                                onClick={() => thisOb.Admin(result['approved'], result['id'], result['author'].first_name ? -result['author']['id'] : result['author']['id'], result['text'], result.moderator_comment !== undefined ? result['moderator_comment']['text'] : null,avatar, result['mark'])}\n                                is_special={thisOb.props.account.special}\n                                is_mark={result.mark}\n                                sendRayt_false={() => thisOb.sendRayt(false, result.id)}\n                                sendRayt_true={() => thisOb.sendRayt(true, result.id)}\n                                approved={result.approved ? true : false}\n                                CanselApp={() => props.this.showAlert('Информация', 'Этот ответ оценен отрицательно')}\n                                DoneApp={() => props.this.showAlert('Информация', 'Этот ответ оценен положительно')}\n                            >\n                                {result.text}\n                            </Message>\n                        )}) : null}\n                        {!((this.state.tiket_info['status'] === 1) || (this.state.tiket_info['status'] === 2)) ? <div style={{marginBottom: '20vh'}}></div> : <div style={{marginBottom: '5vh'}}></div>}\n                      </>\n            {/* INPUT */}\n            {this.state.tiket_info['status'] === 0 || (this.state.redaction === true || this.state.add_comment === true) ? \n                (this.state.limitreach && !(this.state.redaction || this.state.add_comment)) ? \n                <FixedLayout filled vertical='bottom'>\n                  <Div>\n                    <FormStatus header='Внимание!' mode='default'>\n                      Вы исчерпали лимит сообщений в этот тикет.\n                    </FormStatus>\n                  </Div>\n                </FixedLayout> :\n                <FixedLayout vertical='bottom'>\n                  <Separator wide />\n                    <WriteBar\n                      after={\n                        <>\n                          <WriteBarIcon mode={this.state.redaction ? 'done' : \"send\"}\n                          disabled={!(this.state.tiket_send_message.trim().length >= 5)}\n                          onClick={() => {(this.state.tiket_send_message.trim().length >= 5) ? this.state.redaction !== true && this.state.add_comment !== true ? this.sendNewMessage() : this.state.redaction ? this.sendNewMessageRedact() : this.sendNewMessageComment() : this.nofinc()}}\n                          />\n                          {/* {<WriteBarIcon><Icon20Clear width={34} height={34} /></WriteBarIcon>} */}\n                        </>\n                      }\n                      value={this.state.tiket_send_message}\n                      maxLength=\"2020\"\n                      name=\"tiket_send_message\"\n                      onChange={(e) => this.onChange(e)}\n                      placeholder=\"Сообщение\"\n                    />\n                </FixedLayout>\n                \n                 : null}\n            {this.state.tiket_info['status'] === 1 ? \n                Number(this.state.tiket_info['author']['id']) === Number(parsedHash.vk_user_id) ?\n                    <div>\n                      <FixedLayout vertical=\"bottom\">\n                        <Div style={{display: \"flex\"}}>\n                          <Button size=\"l\" style={{marginRight: \"5%\"}} stretched onClick={() => this.deleteTicket()}>Проблема решена</Button>\n                          <Button size=\"l\" stretched mode=\"secondary\" onClick={() => this.openTicket()}>Проблема не решена</Button>\n                        </Div>\n                      </FixedLayout>\n                        \n                    </div>\n                : null\n            : null}\n            {this.state.snackbar}\n            </> : null}\n            </Panel>\n        )\n    }\n};\n"]},"metadata":{},"sourceType":"module"}