{"ast":null,"code":"import _classCallCheck from\"C:\\\\Users\\\\rshub\\\\Desktop\\\\Road-to-Jedi\\\\mobile-road\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/classCallCheck\";import _createClass from\"C:\\\\Users\\\\rshub\\\\Desktop\\\\Road-to-Jedi\\\\mobile-road\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/createClass\";import _inherits from\"C:\\\\Users\\\\rshub\\\\Desktop\\\\Road-to-Jedi\\\\mobile-road\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/inherits\";import _createSuper from\"C:\\\\Users\\\\rshub\\\\Desktop\\\\Road-to-Jedi\\\\mobile-road\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/createSuper\";import React from'react';import{Panel,PanelHeader,Avatar,Placeholder,Separator,PullToRefresh,PanelSpinner,SimpleCell,PanelHeaderBack}from'@vkontakte/vkui';import Icon56NotificationOutline from'@vkontakte/icons/dist/56/notification_outline';function fix_time(time){if(time<10){return\"0\"+time;}else{return time;}}var month=['января','февраля','марта','апреля','мая','июня','июля','августа','сентября','октября','ноября','декабря'];var ReaderNotif=/*#__PURE__*/function(_React$Component){_inherits(ReaderNotif,_React$Component);var _super=_createSuper(ReaderNotif);function ReaderNotif(props){var _this;_classCallCheck(this,ReaderNotif);_this=_super.call(this,props);_this.state={notification:null,fetching:false};_this.getNotif=function(){fetch(_this.props.this.state.api_url+\"method=notifications.get&\"+window.location.search.replace('?','')).then(function(res){return res.json();}).then(function(data){if(data.result){_this.setState({notification:data.response});setTimeout(function(){_this.setState({fetching:false});},500);}else{_this.props.this.showErrorAlert(data.error.message);}}).catch(function(err){_this.props.this.showErrorAlert('Ошибка запроса. Пожалуйста, попробуйте позже',function(){_this.changeData('activeStory','disconnect');});});};_this.markView=function(){fetch(_this.props.this.state.api_url+\"method=notifications.markAsViewed&\"+window.location.search.replace('?','')).then(function(res){return res.json();}).then(function(data){if(data.result){setTimeout(function(){_this.props.this.ReloadProfile();},4000);}else{_this.props.this.showErrorAlert(data.error.message);}}).catch(function(err){_this.props.this.showErrorAlert('Ошибка запроса. Пожалуйста, попробуйте позже',function(){_this.changeData('activeStory','disconnect');});});};return _this;}_createClass(ReaderNotif,[{key:\"componentDidMount\",value:function componentDidMount(){this.getNotif();this.markView();}},{key:\"render\",value:function render(){var _this2=this;var props=this.props.this;// для более удобного использования.\nreturn/*#__PURE__*/React.createElement(Panel,{id:this.props.id},/*#__PURE__*/React.createElement(PanelHeader,{left:/*#__PURE__*/React.createElement(PanelHeaderBack,{onClick:function onClick(){_this2.props.this.changeData(\"activeStory\",'profile');}})},\"\\u0423\\u0432\\u0435\\u0434\\u043E\\u043C\\u043B\\u0435\\u043D\\u0438\\u044F\"),/*#__PURE__*/React.createElement(React.Fragment,null,/*#__PURE__*/React.createElement(PullToRefresh,{onRefresh:function onRefresh(){_this2.setState({fetching:true});_this2.getNotif();},isFetching:this.state.fetching},this.state.notification?this.state.notification.length>0?this.state.notification.map(function(result,i){return/*#__PURE__*/React.createElement(React.Fragment,{key:i},/*#__PURE__*/React.createElement(SimpleCell,{onClick:result['object']['object']!=='0'?function(){return props.goTiket(result['object']['object']);}:function(){return props.openMoneyTransfer(result['image'],result['text'],result['comment']);},description:new Date(result['time']*1e3).getDate()+\" \"+month[new Date(result['time']*1e3).getMonth()]+\" \"+new Date(result['time']*1e3).getFullYear()+\" в \"+fix_time(new Date(result['time']*1e3).getHours())+\":\"+fix_time(new Date(result['time']*1e3).getMinutes()),size:\"l\",before:/*#__PURE__*/React.createElement(Avatar,{src:result['image']}),multiline:\"boolean\"},/*#__PURE__*/React.createElement(\"div\",{style:{lineHeight:\"17px\",marginTop:\"3px\"}},result['text']),/*#__PURE__*/React.createElement(\"div\",{style:{marginTop:\"4px\"}})),/*#__PURE__*/React.createElement(Separator,{className:{width:\"100%\"}}));}):/*#__PURE__*/React.createElement(Placeholder,{icon:/*#__PURE__*/React.createElement(Icon56NotificationOutline,null)},\"\\u0423 \\u0412\\u0430\\u0441 \\u043D\\u0435\\u0442 \\u043D\\u043E\\u0432\\u044B\\u0445 \\u0443\\u0432\\u0435\\u0434\\u043E\\u043C\\u043B\\u0435\\u043D\\u0438\\u0439\"):/*#__PURE__*/React.createElement(PanelSpinner,null))));}}]);return ReaderNotif;}(React.Component);export{ReaderNotif as default};","map":{"version":3,"sources":["C:/Users/rshub/Desktop/Road-to-Jedi/mobile-road/src/panels/notify/panels/notif.js"],"names":["React","Panel","PanelHeader","Avatar","Placeholder","Separator","PullToRefresh","PanelSpinner","SimpleCell","PanelHeaderBack","Icon56NotificationOutline","fix_time","time","month","ReaderNotif","props","state","notification","fetching","getNotif","fetch","this","api_url","window","location","search","replace","then","res","json","data","result","setState","response","setTimeout","showErrorAlert","error","message","catch","err","changeData","markView","ReloadProfile","id","length","map","i","goTiket","openMoneyTransfer","Date","getDate","getMonth","getFullYear","getHours","getMinutes","lineHeight","marginTop","width","Component"],"mappings":"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","sourcesContent":["import React from 'react';\n\nimport { \n    Panel,\n    PanelHeader,\n    Avatar,\n    Placeholder,\n    Separator,\n    PullToRefresh,\n    PanelSpinner,\n    SimpleCell,\n    PanelHeaderBack,\n    } from '@vkontakte/vkui';\n\nimport Icon56NotificationOutline from '@vkontakte/icons/dist/56/notification_outline';\n\nfunction fix_time(time) {\n    if(time < 10) {\n        return \"0\" + time\n    } else {\n        return time\n    }\n}\n\nvar month= [\n    'января',\n    'февраля',\n    'марта',\n    'апреля',\n    'мая',\n    'июня',\n    'июля',\n    'августа',\n    'сентября',\n    'октября',\n    'ноября',\n    'декабря',\n];\n\n\nexport default class ReaderNotif extends React.Component {\n        constructor(props) {\n            super(props);\n            this.state = {\n                notification: null,\n                fetching: false,\n\n            }\n\n            this.getNotif = () => {\n                fetch(this.props.this.state.api_url + \"method=notifications.get&\" + window.location.search.replace('?', ''))\n                .then(res => res.json())\n                .then(data => {\n                if(data.result) {\n                    this.setState({notification: data.response})\n                    setTimeout(() => {\n                        this.setState({ fetching: false });\n                      }, 500);\n                }else {\n                   this.props.this.showErrorAlert(data.error.message)\n                  }\n                })\n                .catch(err => {\n                this.props.this.showErrorAlert('Ошибка запроса. Пожалуйста, попробуйте позже',() => {this.changeData('activeStory', 'disconnect')})\n\n                })\n            }\n            this.markView = () => {\n                fetch(this.props.this.state.api_url + \"method=notifications.markAsViewed&\" + window.location.search.replace('?', ''))\n                .then(res => res.json())\n                .then(data => {\n                if(data.result) {\n                    setTimeout(() => {\n                        this.props.this.ReloadProfile();\n                      }, 4000)\n                }else {\n                   this.props.this.showErrorAlert(data.error.message)\n                  }\n                })\n                .catch(err => {\n                this.props.this.showErrorAlert('Ошибка запроса. Пожалуйста, попробуйте позже',() => {this.changeData('activeStory', 'disconnect')})\n\n                })\n            }\n        }\n        componentDidMount() {\n            this.getNotif();\n            this.markView();\n        }\n        \n\n        render() {\n            var props = this.props.this; // для более удобного использования.\n            return (\n                <Panel id={this.props.id}>\n                <PanelHeader\n                left={<PanelHeaderBack onClick={() => {this.props.this.changeData(\"activeStory\", 'profile');}} />}>\n                Уведомления\n                </PanelHeader>\n                <><PullToRefresh onRefresh={() => {this.setState({fetching: true});this.getNotif()}} isFetching={this.state.fetching}>\n                    {this.state.notification ? this.state.notification.length > 0 ?\n                    this.state.notification.map((result, i) =>\n                    <React.Fragment key={i}> \n                        <SimpleCell\n                            onClick={result['object']['object'] !== '0' ? () => props.goTiket(result['object']['object']) : () => props.openMoneyTransfer(result['image'], result['text'], result['comment'])}\n                            description={new Date(result['time'] * 1e3).getDate() + \" \" + month[new Date(result['time'] * 1e3).getMonth()] + \" \" + new Date(result['time'] * 1e3).getFullYear() + \" в \" \n                            + fix_time(new Date(result['time'] * 1e3).getHours()) + \":\" + fix_time(new Date(result['time'] * 1e3).getMinutes())}\n                            size=\"l\"\n                            before={<Avatar src={result['image']} />}\n                            multiline=\"boolean\"\n                        >\n                            <div style={{lineHeight: \"17px\", marginTop: \"3px\"}}>{result['text']}</div>\n                            <div style={{marginTop: \"4px\"}}></div>\n                        </SimpleCell>\n                        <Separator className={{width: \"100%\"}}></Separator>\n                    </React.Fragment>\n                    ) :\n                    <Placeholder \n                    icon={<Icon56NotificationOutline />}>\n                        У Вас нет новых уведомлений\n                    </Placeholder>\n                    :\n                    <PanelSpinner />\n                    }\n                </PullToRefresh></>\n            </Panel>\n            )\n            }\n        }\n  "]},"metadata":{},"sourceType":"module"}