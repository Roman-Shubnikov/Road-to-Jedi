{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\rshub\\\\Desktop\\\\Road-to-Jedi\\\\mobile-road\\\\src\\\\panels\\\\notify\\\\panels\\\\notif.js\";\nimport React from 'react';\nimport { Panel, PanelHeader, Avatar, Placeholder, Separator, PullToRefresh, PanelSpinner, SimpleCell } from '@vkontakte/vkui';\nimport Icon56NotificationOutline from '@vkontakte/icons/dist/56/notification_outline';\n\nfunction fix_time(time) {\n  if (time < 10) {\n    return \"0\" + time;\n  } else {\n    return time;\n  }\n}\n\nvar month = ['января', 'февраля', 'марта', 'апреля', 'мая', 'июня', 'июля', 'августа', 'сентября', 'октября', 'ноября', 'декабря'];\nexport default class ReaderNotif extends React.Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      notification: null,\n      fetching: false\n    };\n\n    this.getNotif = () => {\n      fetch(this.props.this.state.api_url + \"method=notifications.get&\" + window.location.search.replace('?', '')).then(res => res.json()).then(data => {\n        if (data.result) {\n          this.setState({\n            notification: data.response\n          });\n          setTimeout(() => {\n            this.setState({\n              fetching: false\n            });\n          }, 500);\n        } else {\n          this.props.this.showErrorAlert(data.error.message);\n        }\n      }).catch(err => {\n        this.props.this.showErrorAlert();\n      });\n    };\n\n    this.markView = () => {\n      fetch(this.props.this.state.api_url + \"method=notifications.markAsViewed&\" + window.location.search.replace('?', '')).then(res => res.json()).then(data => {\n        if (data.result) {\n          console.log('marked');\n        } else {\n          this.props.this.showErrorAlert(data.error.message);\n        }\n      }).catch(err => {\n        this.props.this.showErrorAlert();\n      });\n    };\n  }\n\n  componentDidMount() {\n    this.getNotif();\n    this.markView();\n  }\n\n  render() {\n    var props = this.props.this; // для более удобного использования.\n\n    return /*#__PURE__*/React.createElement(Panel, {\n      id: this.props.id,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 92,\n        columnNumber: 17\n      }\n    }, /*#__PURE__*/React.createElement(PanelHeader, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 93,\n        columnNumber: 17\n      }\n    }, \"\\u0423\\u0432\\u0435\\u0434\\u043E\\u043C\\u043B\\u0435\\u043D\\u0438\\u044F\"), /*#__PURE__*/React.createElement(React.Fragment, null, /*#__PURE__*/React.createElement(PullToRefresh, {\n      onRefresh: () => {\n        this.setState({\n          fetching: true\n        });\n        this.getNotif();\n      },\n      isFetching: this.state.fetching,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 96,\n        columnNumber: 19\n      }\n    }, this.state.notification ? this.state.notification.length > 0 ? this.state.notification.map((result, i) => /*#__PURE__*/React.createElement(React.Fragment, {\n      key: i,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 99,\n        columnNumber: 21\n      }\n    }, /*#__PURE__*/React.createElement(SimpleCell, {\n      onClick: result['object']['object'] !== '0' ? () => props.goTiket(result['object']['object']) : () => props.openMoneyTransfer(result['image'], result['text'], result['comment']),\n      description: new Date(result['time'] * 1e3).getDate() + \" \" + month[new Date(result['time'] * 1e3).getMonth()] + \" \" + new Date(result['time'] * 1e3).getFullYear() + \" в \" + fix_time(new Date(result['time'] * 1e3).getHours()) + \":\" + fix_time(new Date(result['time'] * 1e3).getMinutes()),\n      size: \"l\",\n      before: /*#__PURE__*/React.createElement(Avatar, {\n        src: result['image'],\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 105,\n          columnNumber: 37\n        }\n      }),\n      multiline: \"boolean\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 100,\n        columnNumber: 25\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      style: {\n        lineHeight: \"17px\",\n        marginTop: \"3px\"\n      },\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 108,\n        columnNumber: 29\n      }\n    }, result['text']), /*#__PURE__*/React.createElement(\"div\", {\n      style: {\n        marginTop: \"4px\"\n      },\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 109,\n        columnNumber: 29\n      }\n    })), /*#__PURE__*/React.createElement(Separator, {\n      className: {\n        width: \"100%\"\n      },\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 111,\n        columnNumber: 25\n      }\n    }))) : /*#__PURE__*/React.createElement(Placeholder, {\n      stretched: true,\n      icon: /*#__PURE__*/React.createElement(Icon56NotificationOutline, {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 116,\n          columnNumber: 27\n        }\n      }),\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 114,\n        columnNumber: 21\n      }\n    }, \"\\u0423 \\u0412\\u0430\\u0441 \\u043D\\u0435\\u0442 \\u043D\\u043E\\u0432\\u044B\\u0445 \\u0443\\u0432\\u0435\\u0434\\u043E\\u043C\\u043B\\u0435\\u043D\\u0438\\u0439\") : /*#__PURE__*/React.createElement(PanelSpinner, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 120,\n        columnNumber: 21\n      }\n    }))));\n  }\n\n}","map":{"version":3,"sources":["C:/Users/rshub/Desktop/Road-to-Jedi/mobile-road/src/panels/notify/panels/notif.js"],"names":["React","Panel","PanelHeader","Avatar","Placeholder","Separator","PullToRefresh","PanelSpinner","SimpleCell","Icon56NotificationOutline","fix_time","time","month","ReaderNotif","Component","constructor","props","state","notification","fetching","getNotif","fetch","this","api_url","window","location","search","replace","then","res","json","data","result","setState","response","setTimeout","showErrorAlert","error","message","catch","err","markView","console","log","componentDidMount","render","id","length","map","i","goTiket","openMoneyTransfer","Date","getDate","getMonth","getFullYear","getHours","getMinutes","lineHeight","marginTop","width"],"mappings":";AAAA,OAAOA,KAAP,MAAkB,OAAlB;AAEA,SACIC,KADJ,EAEIC,WAFJ,EAGIC,MAHJ,EAIIC,WAJJ,EAKIC,SALJ,EAMIC,aANJ,EAOIC,YAPJ,EAQIC,UARJ,QASW,iBATX;AAWA,OAAOC,yBAAP,MAAsC,+CAAtC;;AAEA,SAASC,QAAT,CAAkBC,IAAlB,EAAwB;AACpB,MAAGA,IAAI,GAAG,EAAV,EAAc;AACV,WAAO,MAAMA,IAAb;AACH,GAFD,MAEO;AACH,WAAOA,IAAP;AACH;AACJ;;AAED,IAAIC,KAAK,GAAE,CACP,QADO,EAEP,SAFO,EAGP,OAHO,EAIP,QAJO,EAKP,KALO,EAMP,MANO,EAOP,MAPO,EAQP,SARO,EASP,UATO,EAUP,SAVO,EAWP,QAXO,EAYP,SAZO,CAAX;AAgBA,eAAe,MAAMC,WAAN,SAA0Bb,KAAK,CAACc,SAAhC,CAA0C;AACjDC,EAAAA,WAAW,CAACC,KAAD,EAAQ;AACf,UAAMA,KAAN;AACA,SAAKC,KAAL,GAAa;AACTC,MAAAA,YAAY,EAAE,IADL;AAETC,MAAAA,QAAQ,EAAE;AAFD,KAAb;;AAMA,SAAKC,QAAL,GAAgB,MAAM;AAClBC,MAAAA,KAAK,CAAC,KAAKL,KAAL,CAAWM,IAAX,CAAgBL,KAAhB,CAAsBM,OAAtB,GAAgC,2BAAhC,GAA8DC,MAAM,CAACC,QAAP,CAAgBC,MAAhB,CAAuBC,OAAvB,CAA+B,GAA/B,EAAoC,EAApC,CAA/D,CAAL,CACCC,IADD,CACMC,GAAG,IAAIA,GAAG,CAACC,IAAJ,EADb,EAECF,IAFD,CAEMG,IAAI,IAAI;AACd,YAAGA,IAAI,CAACC,MAAR,EAAgB;AACZ,eAAKC,QAAL,CAAc;AAACf,YAAAA,YAAY,EAAEa,IAAI,CAACG;AAApB,WAAd;AACAC,UAAAA,UAAU,CAAC,MAAM;AACb,iBAAKF,QAAL,CAAc;AAAEd,cAAAA,QAAQ,EAAE;AAAZ,aAAd;AACD,WAFO,EAEL,GAFK,CAAV;AAGH,SALD,MAKM;AACH,eAAKH,KAAL,CAAWM,IAAX,CAAgBc,cAAhB,CAA+BL,IAAI,CAACM,KAAL,CAAWC,OAA1C;AACA;AACF,OAXD,EAYCC,KAZD,CAYOC,GAAG,IAAI;AACd,aAAKxB,KAAL,CAAWM,IAAX,CAAgBc,cAAhB;AAEC,OAfD;AAgBH,KAjBD;;AAkBA,SAAKK,QAAL,GAAgB,MAAM;AAClBpB,MAAAA,KAAK,CAAC,KAAKL,KAAL,CAAWM,IAAX,CAAgBL,KAAhB,CAAsBM,OAAtB,GAAgC,oCAAhC,GAAuEC,MAAM,CAACC,QAAP,CAAgBC,MAAhB,CAAuBC,OAAvB,CAA+B,GAA/B,EAAoC,EAApC,CAAxE,CAAL,CACCC,IADD,CACMC,GAAG,IAAIA,GAAG,CAACC,IAAJ,EADb,EAECF,IAFD,CAEMG,IAAI,IAAI;AACd,YAAGA,IAAI,CAACC,MAAR,EAAgB;AACZU,UAAAA,OAAO,CAACC,GAAR,CAAY,QAAZ;AACH,SAFD,MAEM;AACH,eAAK3B,KAAL,CAAWM,IAAX,CAAgBc,cAAhB,CAA+BL,IAAI,CAACM,KAAL,CAAWC,OAA1C;AACA;AACF,OARD,EASCC,KATD,CASOC,GAAG,IAAI;AACd,aAAKxB,KAAL,CAAWM,IAAX,CAAgBc,cAAhB;AAEC,OAZD;AAaH,KAdD;AAeH;;AACDQ,EAAAA,iBAAiB,GAAG;AAChB,SAAKxB,QAAL;AACA,SAAKqB,QAAL;AACH;;AAGDI,EAAAA,MAAM,GAAG;AACL,QAAI7B,KAAK,GAAG,KAAKA,KAAL,CAAWM,IAAvB,CADK,CACwB;;AAC7B,wBACI,oBAAC,KAAD;AAAO,MAAA,EAAE,EAAE,KAAKN,KAAL,CAAW8B,EAAtB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,oBACA,oBAAC,WAAD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,4EADA,eAIA,uDAAE,oBAAC,aAAD;AAAe,MAAA,SAAS,EAAE,MAAM;AAAC,aAAKb,QAAL,CAAc;AAACd,UAAAA,QAAQ,EAAE;AAAX,SAAd;AAAgC,aAAKC,QAAL;AAAgB,OAAjF;AAAmF,MAAA,UAAU,EAAE,KAAKH,KAAL,CAAWE,QAA1G;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OACG,KAAKF,KAAL,CAAWC,YAAX,GAA0B,KAAKD,KAAL,CAAWC,YAAX,CAAwB6B,MAAxB,GAAiC,CAAjC,GAC3B,KAAK9B,KAAL,CAAWC,YAAX,CAAwB8B,GAAxB,CAA4B,CAAChB,MAAD,EAASiB,CAAT,kBAC5B,oBAAC,KAAD,CAAO,QAAP;AAAgB,MAAA,GAAG,EAAEA,CAArB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,oBACI,oBAAC,UAAD;AACI,MAAA,OAAO,EAAEjB,MAAM,CAAC,QAAD,CAAN,CAAiB,QAAjB,MAA+B,GAA/B,GAAqC,MAAMhB,KAAK,CAACkC,OAAN,CAAclB,MAAM,CAAC,QAAD,CAAN,CAAiB,QAAjB,CAAd,CAA3C,GAAuF,MAAMhB,KAAK,CAACmC,iBAAN,CAAwBnB,MAAM,CAAC,OAAD,CAA9B,EAAyCA,MAAM,CAAC,MAAD,CAA/C,EAAyDA,MAAM,CAAC,SAAD,CAA/D,CAD1G;AAEI,MAAA,WAAW,EAAE,IAAIoB,IAAJ,CAASpB,MAAM,CAAC,MAAD,CAAN,GAAiB,GAA1B,EAA+BqB,OAA/B,KAA2C,GAA3C,GAAiDzC,KAAK,CAAC,IAAIwC,IAAJ,CAASpB,MAAM,CAAC,MAAD,CAAN,GAAiB,GAA1B,EAA+BsB,QAA/B,EAAD,CAAtD,GAAoG,GAApG,GAA0G,IAAIF,IAAJ,CAASpB,MAAM,CAAC,MAAD,CAAN,GAAiB,GAA1B,EAA+BuB,WAA/B,EAA1G,GAAyJ,KAAzJ,GACX7C,QAAQ,CAAC,IAAI0C,IAAJ,CAASpB,MAAM,CAAC,MAAD,CAAN,GAAiB,GAA1B,EAA+BwB,QAA/B,EAAD,CADG,GAC2C,GAD3C,GACiD9C,QAAQ,CAAC,IAAI0C,IAAJ,CAASpB,MAAM,CAAC,MAAD,CAAN,GAAiB,GAA1B,EAA+ByB,UAA/B,EAAD,CAH1E;AAII,MAAA,IAAI,EAAC,GAJT;AAKI,MAAA,MAAM,eAAE,oBAAC,MAAD;AAAQ,QAAA,GAAG,EAAEzB,MAAM,CAAC,OAAD,CAAnB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,QALZ;AAMI,MAAA,SAAS,EAAC,SANd;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,oBAQI;AAAK,MAAA,KAAK,EAAE;AAAC0B,QAAAA,UAAU,EAAE,MAAb;AAAqBC,QAAAA,SAAS,EAAE;AAAhC,OAAZ;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OAAqD3B,MAAM,CAAC,MAAD,CAA3D,CARJ,eASI;AAAK,MAAA,KAAK,EAAE;AAAC2B,QAAAA,SAAS,EAAE;AAAZ,OAAZ;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MATJ,CADJ,eAYI,oBAAC,SAAD;AAAW,MAAA,SAAS,EAAE;AAACC,QAAAA,KAAK,EAAE;AAAR,OAAtB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MAZJ,CADA,CAD2B,gBAiB3B,oBAAC,WAAD;AACA,MAAA,SAAS,MADT;AAEA,MAAA,IAAI,eAAE,oBAAC,yBAAD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,QAFN;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,wJAjBC,gBAuBD,oBAAC,YAAD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MAxBF,CAAF,CAJA,CADJ;AAkCC;;AArF4C","sourcesContent":["import React from 'react';\n\nimport { \n    Panel,\n    PanelHeader,\n    Avatar,\n    Placeholder,\n    Separator,\n    PullToRefresh,\n    PanelSpinner,\n    SimpleCell,\n    } from '@vkontakte/vkui';\n\nimport Icon56NotificationOutline from '@vkontakte/icons/dist/56/notification_outline';\n\nfunction fix_time(time) {\n    if(time < 10) {\n        return \"0\" + time\n    } else {\n        return time\n    }\n}\n\nvar month= [\n    'января',\n    'февраля',\n    'марта',\n    'апреля',\n    'мая',\n    'июня',\n    'июля',\n    'августа',\n    'сентября',\n    'октября',\n    'ноября',\n    'декабря',\n];\n\n\nexport default class ReaderNotif extends React.Component {\n        constructor(props) {\n            super(props);\n            this.state = {\n                notification: null,\n                fetching: false,\n\n            }\n\n            this.getNotif = () => {\n                fetch(this.props.this.state.api_url + \"method=notifications.get&\" + window.location.search.replace('?', ''))\n                .then(res => res.json())\n                .then(data => {\n                if(data.result) {\n                    this.setState({notification: data.response})\n                    setTimeout(() => {\n                        this.setState({ fetching: false });\n                      }, 500);\n                }else {\n                   this.props.this.showErrorAlert(data.error.message)\n                  }\n                })\n                .catch(err => {\n                this.props.this.showErrorAlert()\n\n                })\n            }\n            this.markView = () => {\n                fetch(this.props.this.state.api_url + \"method=notifications.markAsViewed&\" + window.location.search.replace('?', ''))\n                .then(res => res.json())\n                .then(data => {\n                if(data.result) {\n                    console.log('marked')\n                }else {\n                   this.props.this.showErrorAlert(data.error.message)\n                  }\n                })\n                .catch(err => {\n                this.props.this.showErrorAlert()\n\n                })\n            }\n        }\n        componentDidMount() {\n            this.getNotif();\n            this.markView();\n        }\n        \n\n        render() {\n            var props = this.props.this; // для более удобного использования.\n            return (\n                <Panel id={this.props.id}>\n                <PanelHeader>\n                Уведомления\n                </PanelHeader>\n                <><PullToRefresh onRefresh={() => {this.setState({fetching: true});this.getNotif()}} isFetching={this.state.fetching}>\n                    {this.state.notification ? this.state.notification.length > 0 ?\n                    this.state.notification.map((result, i) =>\n                    <React.Fragment key={i}> \n                        <SimpleCell\n                            onClick={result['object']['object'] !== '0' ? () => props.goTiket(result['object']['object']) : () => props.openMoneyTransfer(result['image'], result['text'], result['comment'])}\n                            description={new Date(result['time'] * 1e3).getDate() + \" \" + month[new Date(result['time'] * 1e3).getMonth()] + \" \" + new Date(result['time'] * 1e3).getFullYear() + \" в \" \n                            + fix_time(new Date(result['time'] * 1e3).getHours()) + \":\" + fix_time(new Date(result['time'] * 1e3).getMinutes())}\n                            size=\"l\"\n                            before={<Avatar src={result['image']} />}\n                            multiline=\"boolean\"\n                        >\n                            <div style={{lineHeight: \"17px\", marginTop: \"3px\"}}>{result['text']}</div>\n                            <div style={{marginTop: \"4px\"}}></div>\n                        </SimpleCell>\n                        <Separator className={{width: \"100%\"}}></Separator>\n                    </React.Fragment>\n                    ) :\n                    <Placeholder \n                    stretched\n                    icon={<Icon56NotificationOutline />}>\n                        У Вас нет новых уведомлений\n                    </Placeholder>\n                    :\n                    <PanelSpinner />\n                    }\n                </PullToRefresh></>\n            </Panel>\n            )\n            }\n        }\n  "]},"metadata":{},"sourceType":"module"}